[
  {
    "objectID": "lecture_3.html",
    "href": "lecture_3.html",
    "title": "GLV and experimental data",
    "section": "",
    "text": "For this exploration, we are going to consider a popular type of experiment in which different combinations of species, taken from a species’ pool are co-cultured.\nThese experiments are routinely conducted with plants (for example, to test the relationship between productivity and biodiversity), bacteria (for example, to determine rules of thumb for coexistence), protozoans, etc.\nIn many cases, only the final outcome (i.e., the density of the populations at the end of each experiment) is available/recorded.\nTypically, the pool of species to experiment with contains only species that can grow in isolation.\nIf one has access to a pool of \\(n\\) species, testing all the possible \\(2^n-1\\) combinations obtained by including/excluding each of the species rapidly becomes impractical as \\(n\\) grows. Therefore, all the possible combinations are tested only when \\(n\\) is small, while a small fraction of the possible communities is typically available when \\(n\\) is large.\n\n\n\nFor our explorations, we are going to use recent data from Ishizawa and colleagues, which you can find here:\nH. Ishizawa, Y. Tashiro, D. Inoue, M. Ike, H. Futamata. Learning beyond-pairwise interactions enables the bottom–up prediction of microbial community structure PNAS 121 (7) e2312396121 (2024).\nThe Authors inoculated duckweed (Lemna minor) with synthetic bacterial communities formed by all possible combinations of seven strains. To this end, they cultured the infected duckweed in flasks for 10 days. At the end of the experiment, they plated the communities on agar plates containing antibiotics that would allow the growth only of a particular strain. In this way, they were able to measure the final density of each of the seven strains in each of the \\(2^7 - 1 = 127\\) possible communities, and conducted each experiment in replicate. The full data set reports the outcome of 692 separate experiments!\nMore modestly, here we are going to focus on a smaller pool of three strains taken from the seven available. We therefore have \\(7\\) possible communities, ranging from a single strain growing in isolation to the three strains growing together. For example, a few of the measurements are:\n\n\n\nDW067\nDW102\nDW145\ncommunity\nreplicate\n\n\n\n\n\n\n0.8\n1\n1\n\n\n\n\n0.812\n1\n2\n\n\n\n0.529\n\n2\n1\n\n\n\n0.356\n\n2\n2\n\n\n\n0.703\n0.909\n3\n1\n\n\n\n0.395\n0.661\n3\n2\n\n\n0.386\n0.602\n0.563\n4\n1\n\n\n0.379\n0.774\n0.293\n4\n2\n\n\n\nWe can therefore associate each measurement with a) the strain being measured, \\(i\\); b) the community in which \\(i\\) was grown, \\(k\\); and c) the (biological) replicate experiment, \\(r\\).\n\n\n\nThe simplest model we can write for this type of data is one in which the outcomes of replicate experiments are independent samples from a distribution:\n\\[\n\\tilde{x}^{(k,r)}_i \\sim Q_i\\left(x^{(k)}_i, \\gamma_i^{(k)}\\right)\n\\] where \\(\\tilde{x}_i^{(k, r)}\\) is the observed density of population \\(i\\) for the \\(r\\) replicate in which population \\(i\\) is grown in community \\(k\\). The value \\(x_i^{(k)}\\) represents the true mean of the distribution (i.e., the average if we were to conduct many replicates—hence it does not depend on \\(r\\)), and \\(\\gamma_i^{(k)}\\) is a parameter (or several parameters) controlling the shape of the distribution \\(Q_i\\).\nImplicitly, we are making a very strong assumption: if we observe the community \\(k\\), it is always found around \\(x^{(k)}\\)—i.e., we cannot have true multistability, in which, depending on initial conditions, we end up with different outcomes in which all populations are present (we can still have that, depending on initial condition, the system ends up at different points/attractors, as long as they have different compositions).\nThis model requires estimating all the \\(x_i^{(k)}\\) and \\(\\gamma_i^{(k)}\\), and is therefore not very useful. To make the model applicable to real data, we make another strong assumption:\n\\[\nx_i^{(k)} = \\alpha_i - \\sum_{j \\in k;\\, j\\neq i } \\beta_{ij} x_j^{(k)}\n\\] The interpretation is simple: if population \\(i\\) is grown by itself, it will reach the carrying capacity \\(\\alpha_i\\); if other species are co-cultured along with \\(i\\), they will change the final density of \\(i\\) according to their density (\\(x_j^{(k)}\\)) and an interaction term \\(\\beta_{ij}\\).\nWe perform some manipulations:\n\\[\n\\begin{aligned}\n\\sum_{j \\in k;\\, j\\neq i } \\beta_{ij} x_j^{(k)} + x_i^{(k)} &= \\alpha_i \\\\\n\\sum_{j \\in k;\\, j\\neq i } \\frac{\\beta_{ij}}{\\alpha_i} x_j^{(k)} + \\frac{1}{\\alpha_i} x_i^{(k)} &= 1 \\\\\n\\sum_{j \\in k;\\, j\\neq i } B_{ij} x_j^{(k)} + B_{ii} x_i^{(k)} &= 1 \\\\\n\\sum_{j \\in k}B_{ij} x_j^{(k)} &=1\\\\\n\\left(B^{(k, k)} x^{(k)}\\right)_i &=1\\\\\nB^{(k, k)} x^{(k)} &= 1_{\\|k\\|}\n\\end{aligned}\n\\]\nBut this is exactly the structure of the equilibria for a GLV model, which we have introduced in Lecture 1.\n\n\n\nTake the model:\n\\[\n\\dot{x} = D(x \\circ r)(1_n - Bx)\n\\] with \\(r &gt; 0_n\\); compute all the feasible equilibria and collect them into a matrix \\(E\\). For example:\n\\[\nB = \\begin{pmatrix}\n2 & -3 & 3\\\\\n-2 & 7 & -3\\\\\n2 & -2 & 2\n\\end{pmatrix} \\quad\nE = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n0 & \\frac{1}{7} & 0\\\\\n0 & 0 & \\frac{1}{2}\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n0 & \\frac{5}{8} & \\frac{9}{8}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n\\]\nwhere each row contains a feasible equilibrium (if it exists) corresponding to a given composition.\nConsider the matrix:\n\\[\n1_m 1_n^T - E B^T = \\begin{pmatrix}\n\\color{red} 0 & 2 & 0\\\\\n\\frac{10}{7} & \\color{red} 0 & \\frac{9}{7}\\\\\n-\\frac{1}{2} &\\frac{5}{2} &\\color{red}0\\\\\n\\color{red} 0 & \\color{red} 0 & -\\frac{1}{2}\\\\\n-\\frac{1}{2} & \\color{red} 0 & \\color{red} 0\\\\\n\\color{red} 0 &\\color{red} 0 &\\color{red} 0  \n\\end{pmatrix}\n\\]\nFor each row, we find \\(0\\) for the corresponding population at equilibrium (in red), and the remaining values express \\((1_n - B x^{(k)})_j\\), which has the same sign as the invasion growth rates for population \\(j\\), when \\(r &gt; 0_n\\). Hence, a saturated equilibrium will correspond to a row with nonpositive values (e.g., the community \\(k=\\{1,2\\}\\) is saturated, because population 3 cannot invade when rare).\nNext, call \\(E_i\\) the submatrix obtained selecting only rows for which \\(x_i^{(k)} &gt; 0\\). For example, for population 1:\n\\[\nE_1 = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n\\] We have that:\n\\[\nE_i B_i = 1_l\n\\]\nWhere \\(B_i\\) is the \\(i^\\text{th}\\) row of \\(B\\), and \\(l\\) is the number of experiments in which \\(i\\) is present:\n\\[\nE_1 B_1 = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix} \\begin{pmatrix}\n2\\\\\n-3\\\\\n3\n\\end{pmatrix} = \\begin{pmatrix}\n1\\\\\n1\\\\\n1\n\\end{pmatrix}\n\\] Practically, this means that all the \\(i^\\text{th}\\) component of all the equilibria \\(x^{(k)}\\) of a GLV model belong to a hyperplane in \\(\\mathbb R^n\\) defined by \\(\\sum_{j} B_{ij} x^{(k)}_j = 1\\).\nThis also means that we can recover the values of \\(B_i\\) from the equilibria:\n\\[\nB_i = E_i^{-1}1_n\n\\]\nwhich can be computed when \\(E_i\\) is square. Otherwise, use the Moore-Penrose pseudo-inverse. For example:\n\\[\nE_2 = \\begin{pmatrix}\n0 & \\frac{1}{7} & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n0 & \\frac{5}{8} & \\frac{9}{8}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n\\]\n\\[\n(E_2^T E_2)^{-1}E_2^T 1_4= \\begin{pmatrix}\n-2 \\\\\n7 \\\\\n-3\n\\end{pmatrix} = B_2\n\\]\nThis also provides a naive method to get a draft of \\(B\\) when only the equilibrium values are available.\nThe method is going to return a unique solution provided that each matrix \\(E_i\\) has rank \\(n\\). In practice, this means that, for each population \\(i\\), a) \\(E_i\\) has at least \\(n\\) rows (i.e., population \\(i\\) is present at \\(n\\) distinct equilibria), and b) each species \\(j\\) is present in at least one equilibrium with \\(i\\), i.e., each pair of populations is found in at least one equilibrium.\nThis might be a tall order when \\(n\\) is large, and in the tutorial we will see how to circumvent this issue.\n\n\n\nSuppose that we have estimated the matrix \\(B\\), and that we want to determine whether a certain combination of populations can or cannot coexist. This is useful when we have sufficient data to estimate \\(B\\), but we have not carried out all the possible experiments—we want to predict the outcome of further experiments in advance.\nThen, according to our statistical model, we can take \\(B^{(k,k)}\\) for the desired community \\(k\\), and take the row sums of the inverse:\n\\[\nx^{(k)} = \\left( B^{(k,k)} \\right)^{-1} 1_{\\|k\\|}\n\\]\nIf all the components of \\(x^{(k)}\\) are positive, we assume that this will be the outcome of the experiment. If any of the components is negative, on the other hand, we conclude that the populations cannot coexist.\n\n\n\nThe paragraph above suggests a good way to score matrices in practice (i.e., when the empirically-observed matrix \\(\\tilde{E}\\) is a noisy estimate of a true matrix \\(E\\)):\n\nPropose a matrix \\(B\\)\nCompute \\(x^{(k)}\\) for each observed \\(\\tilde{x}^{(k,r)}\\)\nTry to minimize the distance between the predicted and observed\n\nNaturally, this algorithm relies on a notion of distance. The simplest choice would be to choose \\(B\\) such that the sum of squared deviations is minimized:\n\\[\nSSQ(B) = \\sum_r \\sum_k \\sum_i \\left(\\tilde{x}^{(k,r)}_i - x^{(k)}_i \\right)^2\n\\]\nWhen the values of \\(\\tilde{x}^{(k)}_i\\) vary considerably (as expected when populations interact), minimizing the SSQ will favor matrices that match closely the rows of \\(\\tilde{E}\\) containing large values, such that a 10% error on a small value of \\(\\tilde{x}^{(k)}_i\\) “counts” less than a 1% error for a large value.\nIf we want to put all rows on the same footing, we can implement a Weighted Least Squares scheme, in which\n\\[\nWLS(B) = \\sum_r \\sum_k \\sum_i \\left(\\frac{\\tilde{x}^{(k,r)}_i - x^{(k)}_i}{\\sigma^{(k)}_i} \\right)^2\n\\]\nwhere deviations are weighted by the respective standard deviation (for simplicity, we can take \\(\\sigma_i^{(k)} = \\sqrt{ \\mathbb E\\left((\\tilde{x}_i^{(k,r)})^2 \\right) - \\left( \\mathbb E\\left(\\tilde{x}_i^{(k,r)} \\right)\\right)^2}\\).\nFinally, we can have a likelihood-based approach in which we are trying to maximize the sum of log-likelihoods:\n\\[\n\\mathcal L(B) = \\sum_r \\sum_k \\sum_i \\log P\\left(\\tilde{x}^{(k,r)}_i|x^{(k)}_i, \\gamma_i^{(k)} \\right)\n\\]\nwhere \\(P(x|\\mu, \\gamma)\\) is the density of a probability distribution function whose shape is controlled by parameters \\(\\mu\\) and \\(\\gamma\\).\n\n\n\nThe backbone of the statistical model can be found in numerous articles, which converged to the same solution starting from different angles:\n\nXiao, Y., Angulo, M. T., Friedman, J., Waldor, M. K., Weiss, S. T., & Liu, Y.-Y. (2017). Mapping the ecological networks of microbial communities. Nature Communications, 8(1), 1–12.\nFort, H. (2018). On predicting species yields in multispecies communities: Quantifying the accuracy of the linear Lotka-Volterra generalized model. Ecological Modelling, 387, 154–162.\nMaynard, D. S., Miller, Z. R., & Allesina, S. (2020). Predicting coexistence in experimental ecological communities. Nature Ecology & Evolution, 4(1), 91–100.\nAnsari, A. F., Reddy, Y., Raut, J., & Dixit, N. M. (2021). An efficient and scalable top-down method for predicting structures of microbial communities. Nature Computational Science, 1(9), 619–628.\nDavis, J.D., Olivença, D.V., Brown, S.P. and Voit, E.O., (2022). Methods of quantifying interactions among populations using Lotka-Volterra models. Frontiers in Systems Biology, 2, p.1021897.\n\nFor the tutorial, we are going to closely follow:\n\nSkwara, A., Lemos‐Costa, P., Miller, Z.R. and Allesina, S., 2023. Modelling ecological communities when composition is manipulated experimentally. Methods in Ecology and Evolution, 14(2), pp.696-707.\n\nThe same method can be extended to provide a simple test for phylogenetic effects on competition/growth:\n\nLemos‐Costa, P., Miller, Z.R. and Allesina, S., 2024. Phylogeny structures species’ interactions in experimental ecological communities. Ecology Letters, 27(8), p.e14490."
  },
  {
    "objectID": "lecture_3.html#experiments-in-which-different-combinations-of-species-are-grown-together",
    "href": "lecture_3.html#experiments-in-which-different-combinations-of-species-are-grown-together",
    "title": "GLV and experimental data",
    "section": "",
    "text": "For this exploration, we are going to consider a popular type of experiment in which different combinations of species, taken from a species’ pool are co-cultured.\nThese experiments are routinely conducted with plants (for example, to test the relationship between productivity and biodiversity), bacteria (for example, to determine rules of thumb for coexistence), protozoans, etc.\nIn many cases, only the final outcome (i.e., the density of the populations at the end of each experiment) is available/recorded.\nTypically, the pool of species to experiment with contains only species that can grow in isolation.\nIf one has access to a pool of \\(n\\) species, testing all the possible \\(2^n-1\\) combinations obtained by including/excluding each of the species rapidly becomes impractical as \\(n\\) grows. Therefore, all the possible combinations are tested only when \\(n\\) is small, while a small fraction of the possible communities is typically available when \\(n\\) is large."
  },
  {
    "objectID": "lecture_3.html#example-data",
    "href": "lecture_3.html#example-data",
    "title": "GLV and experimental data",
    "section": "",
    "text": "For our explorations, we are going to use recent data from Ishizawa and colleagues, which you can find here:\nH. Ishizawa, Y. Tashiro, D. Inoue, M. Ike, H. Futamata. Learning beyond-pairwise interactions enables the bottom–up prediction of microbial community structure PNAS 121 (7) e2312396121 (2024).\nThe Authors inoculated duckweed (Lemna minor) with synthetic bacterial communities formed by all possible combinations of seven strains. To this end, they cultured the infected duckweed in flasks for 10 days. At the end of the experiment, they plated the communities on agar plates containing antibiotics that would allow the growth only of a particular strain. In this way, they were able to measure the final density of each of the seven strains in each of the \\(2^7 - 1 = 127\\) possible communities, and conducted each experiment in replicate. The full data set reports the outcome of 692 separate experiments!\nMore modestly, here we are going to focus on a smaller pool of three strains taken from the seven available. We therefore have \\(7\\) possible communities, ranging from a single strain growing in isolation to the three strains growing together. For example, a few of the measurements are:\n\n\n\nDW067\nDW102\nDW145\ncommunity\nreplicate\n\n\n\n\n\n\n0.8\n1\n1\n\n\n\n\n0.812\n1\n2\n\n\n\n0.529\n\n2\n1\n\n\n\n0.356\n\n2\n2\n\n\n\n0.703\n0.909\n3\n1\n\n\n\n0.395\n0.661\n3\n2\n\n\n0.386\n0.602\n0.563\n4\n1\n\n\n0.379\n0.774\n0.293\n4\n2\n\n\n\nWe can therefore associate each measurement with a) the strain being measured, \\(i\\); b) the community in which \\(i\\) was grown, \\(k\\); and c) the (biological) replicate experiment, \\(r\\)."
  },
  {
    "objectID": "lecture_3.html#a-simple-statistical-framework",
    "href": "lecture_3.html#a-simple-statistical-framework",
    "title": "GLV and experimental data",
    "section": "",
    "text": "The simplest model we can write for this type of data is one in which the outcomes of replicate experiments are independent samples from a distribution:\n\\[\n\\tilde{x}^{(k,r)}_i \\sim Q_i\\left(x^{(k)}_i, \\gamma_i^{(k)}\\right)\n\\] where \\(\\tilde{x}_i^{(k, r)}\\) is the observed density of population \\(i\\) for the \\(r\\) replicate in which population \\(i\\) is grown in community \\(k\\). The value \\(x_i^{(k)}\\) represents the true mean of the distribution (i.e., the average if we were to conduct many replicates—hence it does not depend on \\(r\\)), and \\(\\gamma_i^{(k)}\\) is a parameter (or several parameters) controlling the shape of the distribution \\(Q_i\\).\nImplicitly, we are making a very strong assumption: if we observe the community \\(k\\), it is always found around \\(x^{(k)}\\)—i.e., we cannot have true multistability, in which, depending on initial conditions, we end up with different outcomes in which all populations are present (we can still have that, depending on initial condition, the system ends up at different points/attractors, as long as they have different compositions).\nThis model requires estimating all the \\(x_i^{(k)}\\) and \\(\\gamma_i^{(k)}\\), and is therefore not very useful. To make the model applicable to real data, we make another strong assumption:\n\\[\nx_i^{(k)} = \\alpha_i - \\sum_{j \\in k;\\, j\\neq i } \\beta_{ij} x_j^{(k)}\n\\] The interpretation is simple: if population \\(i\\) is grown by itself, it will reach the carrying capacity \\(\\alpha_i\\); if other species are co-cultured along with \\(i\\), they will change the final density of \\(i\\) according to their density (\\(x_j^{(k)}\\)) and an interaction term \\(\\beta_{ij}\\).\nWe perform some manipulations:\n\\[\n\\begin{aligned}\n\\sum_{j \\in k;\\, j\\neq i } \\beta_{ij} x_j^{(k)} + x_i^{(k)} &= \\alpha_i \\\\\n\\sum_{j \\in k;\\, j\\neq i } \\frac{\\beta_{ij}}{\\alpha_i} x_j^{(k)} + \\frac{1}{\\alpha_i} x_i^{(k)} &= 1 \\\\\n\\sum_{j \\in k;\\, j\\neq i } B_{ij} x_j^{(k)} + B_{ii} x_i^{(k)} &= 1 \\\\\n\\sum_{j \\in k}B_{ij} x_j^{(k)} &=1\\\\\n\\left(B^{(k, k)} x^{(k)}\\right)_i &=1\\\\\nB^{(k, k)} x^{(k)} &= 1_{\\|k\\|}\n\\end{aligned}\n\\]\nBut this is exactly the structure of the equilibria for a GLV model, which we have introduced in Lecture 1."
  },
  {
    "objectID": "lecture_3.html#the-structure-of-equilibria-in-glv",
    "href": "lecture_3.html#the-structure-of-equilibria-in-glv",
    "title": "GLV and experimental data",
    "section": "",
    "text": "Take the model:\n\\[\n\\dot{x} = D(x \\circ r)(1_n - Bx)\n\\] with \\(r &gt; 0_n\\); compute all the feasible equilibria and collect them into a matrix \\(E\\). For example:\n\\[\nB = \\begin{pmatrix}\n2 & -3 & 3\\\\\n-2 & 7 & -3\\\\\n2 & -2 & 2\n\\end{pmatrix} \\quad\nE = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n0 & \\frac{1}{7} & 0\\\\\n0 & 0 & \\frac{1}{2}\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n0 & \\frac{5}{8} & \\frac{9}{8}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n\\]\nwhere each row contains a feasible equilibrium (if it exists) corresponding to a given composition.\nConsider the matrix:\n\\[\n1_m 1_n^T - E B^T = \\begin{pmatrix}\n\\color{red} 0 & 2 & 0\\\\\n\\frac{10}{7} & \\color{red} 0 & \\frac{9}{7}\\\\\n-\\frac{1}{2} &\\frac{5}{2} &\\color{red}0\\\\\n\\color{red} 0 & \\color{red} 0 & -\\frac{1}{2}\\\\\n-\\frac{1}{2} & \\color{red} 0 & \\color{red} 0\\\\\n\\color{red} 0 &\\color{red} 0 &\\color{red} 0  \n\\end{pmatrix}\n\\]\nFor each row, we find \\(0\\) for the corresponding population at equilibrium (in red), and the remaining values express \\((1_n - B x^{(k)})_j\\), which has the same sign as the invasion growth rates for population \\(j\\), when \\(r &gt; 0_n\\). Hence, a saturated equilibrium will correspond to a row with nonpositive values (e.g., the community \\(k=\\{1,2\\}\\) is saturated, because population 3 cannot invade when rare).\nNext, call \\(E_i\\) the submatrix obtained selecting only rows for which \\(x_i^{(k)} &gt; 0\\). For example, for population 1:\n\\[\nE_1 = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n\\] We have that:\n\\[\nE_i B_i = 1_l\n\\]\nWhere \\(B_i\\) is the \\(i^\\text{th}\\) row of \\(B\\), and \\(l\\) is the number of experiments in which \\(i\\) is present:\n\\[\nE_1 B_1 = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix} \\begin{pmatrix}\n2\\\\\n-3\\\\\n3\n\\end{pmatrix} = \\begin{pmatrix}\n1\\\\\n1\\\\\n1\n\\end{pmatrix}\n\\] Practically, this means that all the \\(i^\\text{th}\\) component of all the equilibria \\(x^{(k)}\\) of a GLV model belong to a hyperplane in \\(\\mathbb R^n\\) defined by \\(\\sum_{j} B_{ij} x^{(k)}_j = 1\\).\nThis also means that we can recover the values of \\(B_i\\) from the equilibria:\n\\[\nB_i = E_i^{-1}1_n\n\\]\nwhich can be computed when \\(E_i\\) is square. Otherwise, use the Moore-Penrose pseudo-inverse. For example:\n\\[\nE_2 = \\begin{pmatrix}\n0 & \\frac{1}{7} & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n0 & \\frac{5}{8} & \\frac{9}{8}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n\\]\n\\[\n(E_2^T E_2)^{-1}E_2^T 1_4= \\begin{pmatrix}\n-2 \\\\\n7 \\\\\n-3\n\\end{pmatrix} = B_2\n\\]\nThis also provides a naive method to get a draft of \\(B\\) when only the equilibrium values are available.\nThe method is going to return a unique solution provided that each matrix \\(E_i\\) has rank \\(n\\). In practice, this means that, for each population \\(i\\), a) \\(E_i\\) has at least \\(n\\) rows (i.e., population \\(i\\) is present at \\(n\\) distinct equilibria), and b) each species \\(j\\) is present in at least one equilibrium with \\(i\\), i.e., each pair of populations is found in at least one equilibrium.\nThis might be a tall order when \\(n\\) is large, and in the tutorial we will see how to circumvent this issue."
  },
  {
    "objectID": "lecture_3.html#predicting-coexistence",
    "href": "lecture_3.html#predicting-coexistence",
    "title": "GLV and experimental data",
    "section": "",
    "text": "Suppose that we have estimated the matrix \\(B\\), and that we want to determine whether a certain combination of populations can or cannot coexist. This is useful when we have sufficient data to estimate \\(B\\), but we have not carried out all the possible experiments—we want to predict the outcome of further experiments in advance.\nThen, according to our statistical model, we can take \\(B^{(k,k)}\\) for the desired community \\(k\\), and take the row sums of the inverse:\n\\[\nx^{(k)} = \\left( B^{(k,k)} \\right)^{-1} 1_{\\|k\\|}\n\\]\nIf all the components of \\(x^{(k)}\\) are positive, we assume that this will be the outcome of the experiment. If any of the components is negative, on the other hand, we conclude that the populations cannot coexist."
  },
  {
    "objectID": "lecture_3.html#scoring-matrices-b",
    "href": "lecture_3.html#scoring-matrices-b",
    "title": "GLV and experimental data",
    "section": "",
    "text": "The paragraph above suggests a good way to score matrices in practice (i.e., when the empirically-observed matrix \\(\\tilde{E}\\) is a noisy estimate of a true matrix \\(E\\)):\n\nPropose a matrix \\(B\\)\nCompute \\(x^{(k)}\\) for each observed \\(\\tilde{x}^{(k,r)}\\)\nTry to minimize the distance between the predicted and observed\n\nNaturally, this algorithm relies on a notion of distance. The simplest choice would be to choose \\(B\\) such that the sum of squared deviations is minimized:\n\\[\nSSQ(B) = \\sum_r \\sum_k \\sum_i \\left(\\tilde{x}^{(k,r)}_i - x^{(k)}_i \\right)^2\n\\]\nWhen the values of \\(\\tilde{x}^{(k)}_i\\) vary considerably (as expected when populations interact), minimizing the SSQ will favor matrices that match closely the rows of \\(\\tilde{E}\\) containing large values, such that a 10% error on a small value of \\(\\tilde{x}^{(k)}_i\\) “counts” less than a 1% error for a large value.\nIf we want to put all rows on the same footing, we can implement a Weighted Least Squares scheme, in which\n\\[\nWLS(B) = \\sum_r \\sum_k \\sum_i \\left(\\frac{\\tilde{x}^{(k,r)}_i - x^{(k)}_i}{\\sigma^{(k)}_i} \\right)^2\n\\]\nwhere deviations are weighted by the respective standard deviation (for simplicity, we can take \\(\\sigma_i^{(k)} = \\sqrt{ \\mathbb E\\left((\\tilde{x}_i^{(k,r)})^2 \\right) - \\left( \\mathbb E\\left(\\tilde{x}_i^{(k,r)} \\right)\\right)^2}\\).\nFinally, we can have a likelihood-based approach in which we are trying to maximize the sum of log-likelihoods:\n\\[\n\\mathcal L(B) = \\sum_r \\sum_k \\sum_i \\log P\\left(\\tilde{x}^{(k,r)}_i|x^{(k)}_i, \\gamma_i^{(k)} \\right)\n\\]\nwhere \\(P(x|\\mu, \\gamma)\\) is the density of a probability distribution function whose shape is controlled by parameters \\(\\mu\\) and \\(\\gamma\\)."
  },
  {
    "objectID": "lecture_3.html#references-and-further-readings",
    "href": "lecture_3.html#references-and-further-readings",
    "title": "GLV and experimental data",
    "section": "",
    "text": "The backbone of the statistical model can be found in numerous articles, which converged to the same solution starting from different angles:\n\nXiao, Y., Angulo, M. T., Friedman, J., Waldor, M. K., Weiss, S. T., & Liu, Y.-Y. (2017). Mapping the ecological networks of microbial communities. Nature Communications, 8(1), 1–12.\nFort, H. (2018). On predicting species yields in multispecies communities: Quantifying the accuracy of the linear Lotka-Volterra generalized model. Ecological Modelling, 387, 154–162.\nMaynard, D. S., Miller, Z. R., & Allesina, S. (2020). Predicting coexistence in experimental ecological communities. Nature Ecology & Evolution, 4(1), 91–100.\nAnsari, A. F., Reddy, Y., Raut, J., & Dixit, N. M. (2021). An efficient and scalable top-down method for predicting structures of microbial communities. Nature Computational Science, 1(9), 619–628.\nDavis, J.D., Olivença, D.V., Brown, S.P. and Voit, E.O., (2022). Methods of quantifying interactions among populations using Lotka-Volterra models. Frontiers in Systems Biology, 2, p.1021897.\n\nFor the tutorial, we are going to closely follow:\n\nSkwara, A., Lemos‐Costa, P., Miller, Z.R. and Allesina, S., 2023. Modelling ecological communities when composition is manipulated experimentally. Methods in Ecology and Evolution, 14(2), pp.696-707.\n\nThe same method can be extended to provide a simple test for phylogenetic effects on competition/growth:\n\nLemos‐Costa, P., Miller, Z.R. and Allesina, S., 2024. Phylogeny structures species’ interactions in experimental ecological communities. Ecology Letters, 27(8), p.e14490."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "These lecture notes were prepared by Stefano Allesina (sallesina@uchicago.edu) for the Serrapilheira/ICTP-SAIFR Training Program in Quantitative Ecology, 2025 edition.\nCall-out sections contain special material:\n\n\n\n\n\n\nMathematical review\n\n\n\n\n\nThis type of call-out contains brief reviews of important mathematical concepts.\n\n\n\n\n\n\n\n\n\nComputing in R\n\n\n\n\n\nThis type of call-out contains information about coding dynamical systems in R.\n\n\n\n\nResources\nThese are good introductions to theoretical ecology:\n\nCase, An Illustrated Guide to Theoretical Ecology, 1999\nMay and McLean, Theoretical Ecology: Principles and Applications, 2007\nGotelli, A primer of ecology, 2008\nHofbauer and Sigmund Evolutionary Games and Population Dynamics, 1998\n\n\n\nMathematical background\nFollowing the material requires basic notions in calculus, linear algebra and dynamical systems. Students should be familiar with:\n\nFunctions, exponential function, logarithm\nLimits\nDerivatives and chain rule\nIntegration of functions in one and several variables\nTaylor series\nVectors, dot product, cross product\nMatrix product, transpose, determinant, eigenvalue decomposition\nPositive and negative definiteness of a matrix\n\nThese are good websites offering a brief review of these materials, and cheat sheets reporting the main formulas:\n\nPaul’s Online Notes covering calculus I, II and III as well as dynamical systems; the cheat sheets are excellent.\nThe legendary Linear Algebra class by Gilbert Strang, who has written popular books on the subject, and taught legions of students at MIT.\nZiko Kolter has published a brief review of linear algebra concepts.\nLinear algebra in four pages by Ivan Savov.\nLinear algebra visualized by 3Blue1Brown.\nSteve Brunton’s (U. Washington) YouTube channel contains extremely well-done lectures on dynamical systems; for example, here are reviews of derivatives, Taylor series, simulating the logistic map, integrating ODEs in a computer."
  },
  {
    "objectID": "tutorial/tutorial_GLV_data.html",
    "href": "tutorial/tutorial_GLV_data.html",
    "title": "GLV and experimental data — Hands on tutorial",
    "section": "",
    "text": "For our explorations, we are going to use recent data from Ishizawa and colleagues, which you can find here:\nH. Ishizawa, Y. Tashiro, D. Inoue, M. Ike, H. Futamata. Learning beyond-pairwise interactions enables the bottom–up prediction of microbial community structure PNAS 121 (7) e2312396121 (2024).\nThe Authors inoculated duckweed (Lemna minor) with synthetic bacterial communities formed by all possible combinations of seven strains. To this end, they cultured the infected duckweed in flasks for 10 days. At the end of the experiment, they plated the communities on agar plates containing antibiotics that would allow the growth only of a particular strain. In this way, they were able to measure the final density of each of the seven strains in each of the \\(2^7 - 1 = 127\\) possible communities, and conducted each experiment in replicate. The full data set reports the outcome of 692 separate experiments!\nMore modestly, here we are going to focus on a smaller pool of three strains taken from the seven available. We therefore have \\(7\\) possible communities, ranging from a single strain growing in isolation to the three strains growing together.\nHere’s the full table:\n\n\n\nDW067\nDW102\nDW145\n\n\n\n\n\n\n0.8\n\n\n\n\n0.812\n\n\n\n\n0.858\n\n\n\n\n0.874\n\n\n\n\n0.854\n\n\n\n\n0.951\n\n\n\n\n0.823\n\n\n\n\n0.922\n\n\n\n\n1\n\n\n\n0.529\n\n\n\n\n0.356\n\n\n\n\n0.532\n\n\n\n\n0.409\n\n\n\n\n0.416\n\n\n\n\n0.548\n\n\n\n\n0.645\n\n\n\n\n0.41\n\n\n\n\n0.367\n\n\n\n\n0.663\n0.604\n\n\n\n0.703\n0.909\n\n\n\n0.395\n0.661\n\n\n\n0.54\n0.487\n\n\n\n0.919\n0.981\n\n\n\n0.707\n0.828\n\n\n0.729\n\n\n\n\n0.781\n\n\n\n\n0.811\n\n\n\n\n1\n\n\n\n\n0.811\n\n\n\n\n0.793\n\n\n\n\n0.617\n\n\n\n\n0.919\n\n\n\n\n0.645\n\n\n\n\n0.513\n\n0.719\n\n\n0.419\n\n0.428\n\n\n0.432\n\n0.546\n\n\n0.197\n\n0.598\n\n\n0.249\n\n0.904\n\n\n0.242\n\n0.558\n\n\n0.541\n0.563\n\n\n\n0.568\n0.755\n\n\n\n0.371\n0.707\n\n\n\n0.566\n0.524\n\n\n\n0.839\n0.433\n\n\n\n0.796\n0.609\n\n\n\n0.328\n1\n0.416\n\n\n0.321\n0.436\n0.58\n\n\n0.378\n0.57\n0.381\n\n\n0.386\n0.602\n0.563\n\n\n0.379\n0.774\n0.293\n\n\n\nWe can therefore associated each measurement with a) the strain being measured, \\(i\\); b) the community in which \\(i\\) was grown, \\(k\\); and c) the (biological) replicate experiment, \\(r\\).\n\n\n\nWe are going to use the code accompanying the paper\n\nSkwara, A., Lemos‐Costa, P., Miller, Z.R. and Allesina, S., 2023. Modelling ecological communities when composition is manipulated experimentally. Methods in Ecology and Evolution, 14(2), pp.696-707.\n\nwhich you can find here\nhttps://github.com/StefanoAllesina/skwara_et_al_2022/\nwe have slightly massaged the code for this tutorial.\nTo load the code in R change to the directory where you have stored the tutorial, and source this code:\n\nsource(\"skwara_et_al_2022.R\")\n\n\n\n\nFirst, we are going to use all the data to find a matrix \\(B\\) that best encodes the density of the populations. To this end, we try to minimize the SSQ\n\\[\nSSQ(B) = \\sum_r \\sum_k \\sum_i \\left(\\tilde{x}^{(k,r)}_i - x^{(k)}_i \\right)^2\n\\]\nThis can be accomplished by calling:\n\nfull_SSQ &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"full\", # estimate B allowing each coefficient to take the best value\n  goalf = \"SSQ\", # minimize Sum of Squared Deviations\n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n\n\n\n\n\nThe values being printed are the SSQ after each round of numerical optimization (in this case, the calculation converges immediately to the solution).\nThe boxplots show the data (points), as well as the corresponding boxplots, with the horizontal line being the median value of \\(\\tilde{x}_i^{(k,r)}\\) across \\(r\\), the triangle shows the location of the empirical mean. The circle marks the fitted mean value for the combination of strain/community, obtained computing \\(\\left(B^{(k,k)}\\right)^{-1}1_{\\|k\\|}\\). As you can see, we can find a matrix \\(B\\) that recapitulates the observed means quite well.\nThe variable \\(full_SSQ\\) now contains:\n\nglimpse(full_SSQ)\n\nList of 8\n $ data_name    : chr \"Ishizawa_3_strains\"\n $ observed     : num [1:50, 1:3] 0 0 0 0 0 0 0 0 0 0 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:3] \"DW067\" \"DW102\" \"DW145\"\n $ predicted    : num [1:50, 1:3] 0 0 0 0 0 0 0 0 0 0 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:3] \"DW067\" \"DW102\" \"DW145\"\n $ variances    : num [1:50, 1:3] 0 0 0 0 0 0 0 0 0 0 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:3] \"DW067\" \"DW102\" \"DW145\"\n $ B            : num [1:3, 1:3] 1.3 -0.479 0.875 0.246 2.143 ...\n $ pars         : num [1:9] 1.63166 0.02719 -1.28356 -0.00694 0.43581 ...\n $ goal_function: num 1.29\n $ goal_type    : chr \"SSQ\"\n\n\nLet’s plot the predicted vs. observed values:\n\nplot_pred_obs(full_SSQ)\n\n\n\n\nWhere the points mark the predicted vs observed means, and the crosses the full data. The dashed line is the 1:1 line.\n\n\n\nWe can repeat the calculation, but this time trying to minimize\n\\[\nWLS(B) = \\sum_r \\sum_k \\sum_i \\left(\\frac{\\tilde{x}^{(k,r)}_i - x^{(k)}_i}{\\sigma^{(k)}_i} \\right)^2\n\\]\nby calling:\n\nfull_WLS &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"full\", # estimate B allowing each coefficient to take the best value\n  goalf = \"WLS\", \n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n\n\n\n\n\n\nplot_pred_obs(full_WLS)\n\n\n\n\nNotice that the points have moved slightly—this is because we are penalizing deviations differently depending on the measured variance (and thus points with a higher variance can depart more strongly from the 1:1 line).\n\n\n\nNow we take a different approach, and take the observations to be independent samples from a log-normal distribution:\n\\[\n\\tilde{x}_i^{(k,r)} \\sim LN(x_i^{(k)}, \\sigma_i)\n\\]\ni.e., we take each variable to have a mean determined by the corresponding \\(x_i^{(k)}\\), and a variance parameter that depends only on strain identity.\n\nfull_LN &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"full\", # estimate B allowing each coefficient to take the best value\n  goalf = \"LikLN\", \n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n\n\n\n\n\n\nplot_pred_obs(full_LN)\n\n\n\n\nAlso in this case, we obtain a good fit.\n\n\n\nThe ultimate test for this type of model is to be able to predict experimental results before running the experiment.\nIn our case, we can try to leave out one of the 7 communities, and see which model recover the best result:\n\ndt &lt;- read_csv(\"Ishizawa_3_strains.csv\")\n\nRows: 50 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (3): DW067, DW102, DW145\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n# the last row contains an experiment with only DW067 and DW102\ndt %&gt;% slice(40)\n\n# A tibble: 1 × 3\n  DW067 DW102 DW145\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.541 0.563     0\n\nLOO_LN &lt;- run_model_LOO(datafile = \"Ishizawa_3_strains.csv\", model = \"full\", goalf = \"LikLN\", pars = NULL, skipEM = TRUE, plot_results = TRUE, \n                        LOO_row_num =  40 # exclude all experiments with this community\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n\n\n\n\n\n\nLOO_WLS &lt;- run_model_LOO(datafile = \"Ishizawa_3_strains.csv\", model = \"full\", goalf = \"WLS\", pars = NULL, skipEM = TRUE, plot_results = TRUE, \n                        LOO_row_num =  40 # exclude all experiments with this community\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n\n\n\n\n\n\nLOO_SSQ &lt;- run_model_LOO(datafile = \"Ishizawa_3_strains.csv\", model = \"full\", goalf = \"SSQ\", pars = NULL, skipEM = TRUE, plot_results = TRUE, \n                        LOO_row_num =  40 # exclude all experiments with this community\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n\n\n\n\n\nAll three models are quite successful at recovering the observed means for the community we left out.\n\n\n\nWe have seen in the lecture that this approach estimates all \\(n^2\\) coefficients of the matrix \\(B\\). For the approach to be successful, we need to have observed enough combinations of populations growing together (each population must be present in at least \\(n\\) experiments with distinct compositions, each pair of populations must appear in at least one final community). When the number of populations in the pool is large, and experiments are few, this approach is unfeasible. We can therefore try to simplify the model to reduce the number of parameters.\nThe idea brought forward by Skwara et al. is to approximate the matrix \\(B\\) as the sum of a diagonal matrix and a low-rank matrix. For example, a version of the model with only \\(n + 1\\) parameters reads:\n\\[\nB = D(s) + \\alpha 1_n1_n^T\n\\]\ni.e., a model in which each diagonal element \\(B_{ii} = s_i + \\alpha\\) has its own parameter (and thus can take arbitrary values), while the off-diagonals are all the same (i.e., each population has the same “mean-field” effect on all others).\nA more general model using \\(3 n - 1\\) parameters reads:\n\\[\nB = D(s) + u v^T\n\\]\nin which the diagonal coefficients \\(B_{ii} = s_i + u_i v_i\\) can take arbitrary values, while the off-diagonal elements \\(B_{ij} = u_i v_j\\) are constrained; the effect of species \\(j\\) on \\(i\\) depends on two values: \\(v_i\\) that measures how strongly species \\(i\\) respond to the presence of other species, and \\(v_j\\) that measures the magnitude of the typical effect of species \\(j\\). Either \\(u\\) or \\(v\\) can be taken as unitary (i.e., \\(\\sum_i v_i^2 = 1\\)) without loss of generality, thereby bringing the total number of parameters to \\(3n-1\\). When the number of populations is small, this approach does not lead to big gains (e.g., for \\(n=3\\) we have 8 parameters instead of 9), but the reduction in parameters is substantial when \\(n\\) becomes larger (e.g., for the whole data set, \\(n=7\\), and thus we would use 20 parameters instead of 49).\nAnother advantage of this approach is that we can write the inverse in linear time, thereby removing the only big computational hurdle of the approach:\n\\[\\begin{aligned}\nB^{-1} 1_n&= (D(s) + u v^T)^{-1}1_n\\\\\n&= \\left(D(s)^{-1} - \\frac{1}{1 + v^TD(s)^{-1}u}D(s)^{-1} u v^TD(s)^{-1}\\right)1_n\\\\ &= D(s)^{-1}\\left(1_n - \\frac{v^T D(s)^{-1}1_n}{1 + v^TD(s)^{-1}u} u\\right)\n\\end{aligned}\n\\]\nThese models can be derived from the consumer-resource framework that you have seen in class.\nWe can test different versions of the simplified model. A model with only the diagonal and an extra parameter performs very poorly:\n\ndiag_a11 &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"diag_a11t\",\n  goalf = \"LikLN\", \n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n\n\n\n\n\n\nplot_pred_obs(diag_a11)\n\n\n\n\nA model with symmetric interactions, \\(B = D(s) + vv^T\\) does slightly better:\n\ndiag_vvt &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"diag_vvt\",\n  goalf = \"LikLN\", \n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] -38.12933\n[1] -38.36503\n[1] -38.37226\n[1] -38.38069\n[1] -38.38508\n[1] -38.39331\n[1] -38.39618\n[1] -38.39655\n[1] -38.39655\n[1] -38.39655\n\n\n\n\n\n\nplot_pred_obs(diag_vvt)\n\n\n\n\nAnd, finally, the model with 8 parameters, \\(B = D(s) + vw^T\\):\nA model with symmetric interactions, \\(B = D(s) + vv^T\\) does slightly better:\n\ndiag_vwt &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"diag_vwt\",\n  goalf = \"LikLN\", \n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] -34.87107\n[1] -49.06619\n[1] -49.06753\n[1] -49.0681\n[1] -49.0681\n[1] -49.0681\n[1] -49.0681\n[1] -49.06811\n[1] -49.06811\n[1] -49.06811\n\n\n\n\n\n\nplot_pred_obs(diag_vwt)"
  },
  {
    "objectID": "tutorial/tutorial_GLV_data.html#data",
    "href": "tutorial/tutorial_GLV_data.html#data",
    "title": "GLV and experimental data — Hands on tutorial",
    "section": "",
    "text": "For our explorations, we are going to use recent data from Ishizawa and colleagues, which you can find here:\nH. Ishizawa, Y. Tashiro, D. Inoue, M. Ike, H. Futamata. Learning beyond-pairwise interactions enables the bottom–up prediction of microbial community structure PNAS 121 (7) e2312396121 (2024).\nThe Authors inoculated duckweed (Lemna minor) with synthetic bacterial communities formed by all possible combinations of seven strains. To this end, they cultured the infected duckweed in flasks for 10 days. At the end of the experiment, they plated the communities on agar plates containing antibiotics that would allow the growth only of a particular strain. In this way, they were able to measure the final density of each of the seven strains in each of the \\(2^7 - 1 = 127\\) possible communities, and conducted each experiment in replicate. The full data set reports the outcome of 692 separate experiments!\nMore modestly, here we are going to focus on a smaller pool of three strains taken from the seven available. We therefore have \\(7\\) possible communities, ranging from a single strain growing in isolation to the three strains growing together.\nHere’s the full table:\n\n\n\nDW067\nDW102\nDW145\n\n\n\n\n\n\n0.8\n\n\n\n\n0.812\n\n\n\n\n0.858\n\n\n\n\n0.874\n\n\n\n\n0.854\n\n\n\n\n0.951\n\n\n\n\n0.823\n\n\n\n\n0.922\n\n\n\n\n1\n\n\n\n0.529\n\n\n\n\n0.356\n\n\n\n\n0.532\n\n\n\n\n0.409\n\n\n\n\n0.416\n\n\n\n\n0.548\n\n\n\n\n0.645\n\n\n\n\n0.41\n\n\n\n\n0.367\n\n\n\n\n0.663\n0.604\n\n\n\n0.703\n0.909\n\n\n\n0.395\n0.661\n\n\n\n0.54\n0.487\n\n\n\n0.919\n0.981\n\n\n\n0.707\n0.828\n\n\n0.729\n\n\n\n\n0.781\n\n\n\n\n0.811\n\n\n\n\n1\n\n\n\n\n0.811\n\n\n\n\n0.793\n\n\n\n\n0.617\n\n\n\n\n0.919\n\n\n\n\n0.645\n\n\n\n\n0.513\n\n0.719\n\n\n0.419\n\n0.428\n\n\n0.432\n\n0.546\n\n\n0.197\n\n0.598\n\n\n0.249\n\n0.904\n\n\n0.242\n\n0.558\n\n\n0.541\n0.563\n\n\n\n0.568\n0.755\n\n\n\n0.371\n0.707\n\n\n\n0.566\n0.524\n\n\n\n0.839\n0.433\n\n\n\n0.796\n0.609\n\n\n\n0.328\n1\n0.416\n\n\n0.321\n0.436\n0.58\n\n\n0.378\n0.57\n0.381\n\n\n0.386\n0.602\n0.563\n\n\n0.379\n0.774\n0.293\n\n\n\nWe can therefore associated each measurement with a) the strain being measured, \\(i\\); b) the community in which \\(i\\) was grown, \\(k\\); and c) the (biological) replicate experiment, \\(r\\)."
  },
  {
    "objectID": "tutorial/tutorial_GLV_data.html#loading-the-code",
    "href": "tutorial/tutorial_GLV_data.html#loading-the-code",
    "title": "GLV and experimental data — Hands on tutorial",
    "section": "",
    "text": "We are going to use the code accompanying the paper\n\nSkwara, A., Lemos‐Costa, P., Miller, Z.R. and Allesina, S., 2023. Modelling ecological communities when composition is manipulated experimentally. Methods in Ecology and Evolution, 14(2), pp.696-707.\n\nwhich you can find here\nhttps://github.com/StefanoAllesina/skwara_et_al_2022/\nwe have slightly massaged the code for this tutorial.\nTo load the code in R change to the directory where you have stored the tutorial, and source this code:\n\nsource(\"skwara_et_al_2022.R\")"
  },
  {
    "objectID": "tutorial/tutorial_GLV_data.html#sum-of-squares",
    "href": "tutorial/tutorial_GLV_data.html#sum-of-squares",
    "title": "GLV and experimental data — Hands on tutorial",
    "section": "",
    "text": "First, we are going to use all the data to find a matrix \\(B\\) that best encodes the density of the populations. To this end, we try to minimize the SSQ\n\\[\nSSQ(B) = \\sum_r \\sum_k \\sum_i \\left(\\tilde{x}^{(k,r)}_i - x^{(k)}_i \\right)^2\n\\]\nThis can be accomplished by calling:\n\nfull_SSQ &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"full\", # estimate B allowing each coefficient to take the best value\n  goalf = \"SSQ\", # minimize Sum of Squared Deviations\n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n[1] 1.289597\n\n\n\n\n\nThe values being printed are the SSQ after each round of numerical optimization (in this case, the calculation converges immediately to the solution).\nThe boxplots show the data (points), as well as the corresponding boxplots, with the horizontal line being the median value of \\(\\tilde{x}_i^{(k,r)}\\) across \\(r\\), the triangle shows the location of the empirical mean. The circle marks the fitted mean value for the combination of strain/community, obtained computing \\(\\left(B^{(k,k)}\\right)^{-1}1_{\\|k\\|}\\). As you can see, we can find a matrix \\(B\\) that recapitulates the observed means quite well.\nThe variable \\(full_SSQ\\) now contains:\n\nglimpse(full_SSQ)\n\nList of 8\n $ data_name    : chr \"Ishizawa_3_strains\"\n $ observed     : num [1:50, 1:3] 0 0 0 0 0 0 0 0 0 0 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:3] \"DW067\" \"DW102\" \"DW145\"\n $ predicted    : num [1:50, 1:3] 0 0 0 0 0 0 0 0 0 0 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:3] \"DW067\" \"DW102\" \"DW145\"\n $ variances    : num [1:50, 1:3] 0 0 0 0 0 0 0 0 0 0 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:3] \"DW067\" \"DW102\" \"DW145\"\n $ B            : num [1:3, 1:3] 1.3 -0.479 0.875 0.246 2.143 ...\n $ pars         : num [1:9] 1.63166 0.02719 -1.28356 -0.00694 0.43581 ...\n $ goal_function: num 1.29\n $ goal_type    : chr \"SSQ\"\n\n\nLet’s plot the predicted vs. observed values:\n\nplot_pred_obs(full_SSQ)\n\n\n\n\nWhere the points mark the predicted vs observed means, and the crosses the full data. The dashed line is the 1:1 line."
  },
  {
    "objectID": "tutorial/tutorial_GLV_data.html#weighted-leas-squares",
    "href": "tutorial/tutorial_GLV_data.html#weighted-leas-squares",
    "title": "GLV and experimental data — Hands on tutorial",
    "section": "",
    "text": "We can repeat the calculation, but this time trying to minimize\n\\[\nWLS(B) = \\sum_r \\sum_k \\sum_i \\left(\\frac{\\tilde{x}^{(k,r)}_i - x^{(k)}_i}{\\sigma^{(k)}_i} \\right)^2\n\\]\nby calling:\n\nfull_WLS &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"full\", # estimate B allowing each coefficient to take the best value\n  goalf = \"WLS\", \n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n[1] 67.07833\n\n\n\n\n\n\nplot_pred_obs(full_WLS)\n\n\n\n\nNotice that the points have moved slightly—this is because we are penalizing deviations differently depending on the measured variance (and thus points with a higher variance can depart more strongly from the 1:1 line)."
  },
  {
    "objectID": "tutorial/tutorial_GLV_data.html#maximum-likelihood",
    "href": "tutorial/tutorial_GLV_data.html#maximum-likelihood",
    "title": "GLV and experimental data — Hands on tutorial",
    "section": "",
    "text": "Now we take a different approach, and take the observations to be independent samples from a log-normal distribution:\n\\[\n\\tilde{x}_i^{(k,r)} \\sim LN(x_i^{(k)}, \\sigma_i)\n\\]\ni.e., we take each variable to have a mean determined by the corresponding \\(x_i^{(k)}\\), and a variance parameter that depends only on strain identity.\n\nfull_LN &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"full\", # estimate B allowing each coefficient to take the best value\n  goalf = \"LikLN\", \n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n[1] -49.19108\n\n\n\n\n\n\nplot_pred_obs(full_LN)\n\n\n\n\nAlso in this case, we obtain a good fit."
  },
  {
    "objectID": "tutorial/tutorial_GLV_data.html#leave-one-out-cross-validation",
    "href": "tutorial/tutorial_GLV_data.html#leave-one-out-cross-validation",
    "title": "GLV and experimental data — Hands on tutorial",
    "section": "",
    "text": "The ultimate test for this type of model is to be able to predict experimental results before running the experiment.\nIn our case, we can try to leave out one of the 7 communities, and see which model recover the best result:\n\ndt &lt;- read_csv(\"Ishizawa_3_strains.csv\")\n\nRows: 50 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (3): DW067, DW102, DW145\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n# the last row contains an experiment with only DW067 and DW102\ndt %&gt;% slice(40)\n\n# A tibble: 1 × 3\n  DW067 DW102 DW145\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.541 0.563     0\n\nLOO_LN &lt;- run_model_LOO(datafile = \"Ishizawa_3_strains.csv\", model = \"full\", goalf = \"LikLN\", pars = NULL, skipEM = TRUE, plot_results = TRUE, \n                        LOO_row_num =  40 # exclude all experiments with this community\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n[1] -43.08928\n\n\n\n\n\n\nLOO_WLS &lt;- run_model_LOO(datafile = \"Ishizawa_3_strains.csv\", model = \"full\", goalf = \"WLS\", pars = NULL, skipEM = TRUE, plot_results = TRUE, \n                        LOO_row_num =  40 # exclude all experiments with this community\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n[1] 56.05198\n\n\n\n\n\n\nLOO_SSQ &lt;- run_model_LOO(datafile = \"Ishizawa_3_strains.csv\", model = \"full\", goalf = \"SSQ\", pars = NULL, skipEM = TRUE, plot_results = TRUE, \n                        LOO_row_num =  40 # exclude all experiments with this community\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n[1] 1.042831\n\n\n\n\n\nAll three models are quite successful at recovering the observed means for the community we left out."
  },
  {
    "objectID": "tutorial/tutorial_GLV_data.html#simplified-models",
    "href": "tutorial/tutorial_GLV_data.html#simplified-models",
    "title": "GLV and experimental data — Hands on tutorial",
    "section": "",
    "text": "We have seen in the lecture that this approach estimates all \\(n^2\\) coefficients of the matrix \\(B\\). For the approach to be successful, we need to have observed enough combinations of populations growing together (each population must be present in at least \\(n\\) experiments with distinct compositions, each pair of populations must appear in at least one final community). When the number of populations in the pool is large, and experiments are few, this approach is unfeasible. We can therefore try to simplify the model to reduce the number of parameters.\nThe idea brought forward by Skwara et al. is to approximate the matrix \\(B\\) as the sum of a diagonal matrix and a low-rank matrix. For example, a version of the model with only \\(n + 1\\) parameters reads:\n\\[\nB = D(s) + \\alpha 1_n1_n^T\n\\]\ni.e., a model in which each diagonal element \\(B_{ii} = s_i + \\alpha\\) has its own parameter (and thus can take arbitrary values), while the off-diagonals are all the same (i.e., each population has the same “mean-field” effect on all others).\nA more general model using \\(3 n - 1\\) parameters reads:\n\\[\nB = D(s) + u v^T\n\\]\nin which the diagonal coefficients \\(B_{ii} = s_i + u_i v_i\\) can take arbitrary values, while the off-diagonal elements \\(B_{ij} = u_i v_j\\) are constrained; the effect of species \\(j\\) on \\(i\\) depends on two values: \\(v_i\\) that measures how strongly species \\(i\\) respond to the presence of other species, and \\(v_j\\) that measures the magnitude of the typical effect of species \\(j\\). Either \\(u\\) or \\(v\\) can be taken as unitary (i.e., \\(\\sum_i v_i^2 = 1\\)) without loss of generality, thereby bringing the total number of parameters to \\(3n-1\\). When the number of populations is small, this approach does not lead to big gains (e.g., for \\(n=3\\) we have 8 parameters instead of 9), but the reduction in parameters is substantial when \\(n\\) becomes larger (e.g., for the whole data set, \\(n=7\\), and thus we would use 20 parameters instead of 49).\nAnother advantage of this approach is that we can write the inverse in linear time, thereby removing the only big computational hurdle of the approach:\n\\[\\begin{aligned}\nB^{-1} 1_n&= (D(s) + u v^T)^{-1}1_n\\\\\n&= \\left(D(s)^{-1} - \\frac{1}{1 + v^TD(s)^{-1}u}D(s)^{-1} u v^TD(s)^{-1}\\right)1_n\\\\ &= D(s)^{-1}\\left(1_n - \\frac{v^T D(s)^{-1}1_n}{1 + v^TD(s)^{-1}u} u\\right)\n\\end{aligned}\n\\]\nThese models can be derived from the consumer-resource framework that you have seen in class.\nWe can test different versions of the simplified model. A model with only the diagonal and an extra parameter performs very poorly:\n\ndiag_a11 &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"diag_a11t\",\n  goalf = \"LikLN\", \n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n[1] -22.62175\n\n\n\n\n\n\nplot_pred_obs(diag_a11)\n\n\n\n\nA model with symmetric interactions, \\(B = D(s) + vv^T\\) does slightly better:\n\ndiag_vvt &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"diag_vvt\",\n  goalf = \"LikLN\", \n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] -38.12933\n[1] -38.36503\n[1] -38.37226\n[1] -38.38069\n[1] -38.38508\n[1] -38.39331\n[1] -38.39618\n[1] -38.39655\n[1] -38.39655\n[1] -38.39655\n\n\n\n\n\n\nplot_pred_obs(diag_vvt)\n\n\n\n\nAnd, finally, the model with 8 parameters, \\(B = D(s) + vw^T\\):\nA model with symmetric interactions, \\(B = D(s) + vv^T\\) does slightly better:\n\ndiag_vwt &lt;- run_model(\n  datafile = \"Ishizawa_3_strains.csv\", # csv file containing the data to be fit\n  model = \"diag_vwt\",\n  goalf = \"LikLN\", \n  pars = NULL, # start from Identity matrix\n  skipEM = TRUE, # go directly to numerical optimization\n  plot_results = TRUE # plot the results\n)\n\n`mutate_if()` ignored the following grouping variables:\n• Column `comm`\n\n\n[1] \"numerical search\"\n[1] -34.87107\n[1] -49.06619\n[1] -49.06753\n[1] -49.0681\n[1] -49.0681\n[1] -49.0681\n[1] -49.0681\n[1] -49.06811\n[1] -49.06811\n[1] -49.06811\n\n\n\n\n\n\nplot_pred_obs(diag_vwt)"
  },
  {
    "objectID": "lecture_2.html",
    "href": "lecture_2.html",
    "title": "GLV with random parameters",
    "section": "",
    "text": "Suppose we take \\(n\\) populations, each growing according to:\n\\[\n\\dot{x}_i = x_i (r_i - A_{ii} x_i)\n\\]\nwith \\(A_{ii} &gt; 0\\). We assume that the growth rates are sampled independently from a distribution: \\(r_i \\sim Q\\), a distribution with mean \\(0\\), \\(\\mathbb E(r_i) = 0\\) and symmetric about its mean, such that \\(\\phi(r_i) = \\phi(-r_i)\\), where \\(\\phi(\\cdot)\\) is the p.d.f. of distribution \\(Q\\). For example, we could choose \\(r_i \\sim \\mathcal N(0, \\sigma^2)\\), or \\(r_i \\sim \\mathcal U[-1, 1]\\). Naturally, whenever \\(r_i &gt; 0\\), the population will grow to \\(x_i^\\star = r_i / A_{ii}\\). If \\(r_i &lt; 0\\), on the other hand, the population will go extinct. Because of the symmetry around zero, each population has therefore probability \\(1/2\\) of persisting. When we have \\(n\\) populations, the number of coexisting populations \\(\\|k\\|\\) is a random variable following the binomial distribution:\n\\[\np(\\|k\\| | n) = \\binom{n}{\\|k\\|} \\frac{1}{2^n}\\quad \\|k\\| \\sim \\mathcal B\\left(n, \\frac{1}{2}\\right)\n\\]\n\n\n\nNow consider a GLV model with random parameters. We choose \\(r_i\\) from a distribution with mean zero and symmetric about the mean, and each interaction \\(A_{ij}\\) from a distribution with mean zero and symmetric about the mean. Moreover, we add a constant to the diagonal of the matrix such that the symmetric part of \\(A\\), \\(H(A) = \\frac{1}{2} (A + A^T)\\) is positive definite. As we have seen before, this means that dynamics will always converge to a saturated equilibrium.\nWe now introduce a family of \\(2^n\\) matrices \\(S_i\\), with:\n\\[\n\\begin{aligned}\nS_1 &= \\begin{pmatrix}\n1 & 0 & 0 & \\cdots & 0\\\\\n0 & 1 & 0 & \\cdots & 0\\\\\n0 & 0 & 0 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} = I_n\\\\\nS_2 &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & 1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} \\\\\nS_3 &= \\begin{pmatrix}\n1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} \\\\\nS_4 &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix}\\\\\n\\vdots\\\\\nS_{2^n} &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & -1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &-1\n\\end{pmatrix} = -I_n\\\\\n\\end{aligned}\n\\]\nThese matrices, called signature matrices are their own inverse (a matrix with this property is called involutory), and therefore, we have that \\(S_i S_i = S_i^2 = I_n\\). Geometrically, these matrices represent a reflection in each of the axes corresponding to the negated rows or columns.\nWe then consider what happens when we transform the parameters by multiplying them by \\(S_i\\). Take an arbitrary GLV system, and solve for the \\(x\\) that makes \\(r + Ax = 0_n\\):\n\\[\nx = -A^{-1} r\n\\]\nThe vector is a feasible equilibrium for the system if \\(x &gt; 0_n\\). Now consider the transformed system:\n\\[\nr' = S_i r \\quad A' = S_iAS_i\n\\]\nNote that \\(A'\\) is similar to \\(A\\), and therefore has the same eigenvalues; moreover, \\(\\phi(r') = \\phi(r)\\) and \\(\\phi(A') = \\phi(A)\\), because of symmetry. Now compute the new solution\n\\[\n\\begin{aligned}\nx' &= -(S_iAS_i)^{-1} S_i r\\\\ &=-S_iA^{-1}S_i S_i r\\\\\n&=-S_iA^{-1}r\\\\\n&= S_i x\n\\end{aligned}\n\\]\nThat is, the transformation changes the sign of the components of \\(x\\) corresponding to the negative coefficients in \\(S_i\\). Hence, for any possible choice of \\(r\\) and \\(A\\), there is only one possible choice of \\(S_i\\) that makes the equilibrium feasible. Because all matrices \\(A'\\) and all vectors \\(r'\\) have the same probability/density, then the probability of having a positive \\(x\\) is exactly \\(1/2^n\\). Thus, a system with random parameters and a strongly stable matrix of interactions has the same probability of feasibility as that of a system in which populations are not interacting!\nWe have seen that when \\(A\\) is such that \\(H(A)\\) is negative definite, dynamics always converge to a saturated equilibrium. We want to compute the probability of finding a saturated equilibrium, in which populations belonging to set \\(k\\) coexist, and the remaining populations cannot invade when rare.\nWe thus divide \\(x\\), \\(r\\) and \\(A\\) as:\n\\[\nx = \\begin{pmatrix}\ny\\\\\nz\n\\end{pmatrix} \\quad \\tilde{x} = \\begin{pmatrix}\ny^\\star\\\\\n0_{\\|n-k\\|}\n\\end{pmatrix} \\quad A = \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\quad r = \\begin{pmatrix}\n\\mathfrak r\\\\\n\\mathfrak s\n\\end{pmatrix}\n\\]\nWe also divide \\(S_i\\) into:\n\\[\nS_i = \\begin{pmatrix}\nS_{i}^{(k)} & 0_{\\|k\\|, \\|n-k\\|}\\\\\n0_{\\|n-k\\|, \\|n\\|} & S_{i}^{(n-k)}\n\\end{pmatrix}\n\\]\nWhen we use the signature matrix, the vector \\(\\mathfrak s\\) and the matrix \\(\\mathfrak C\\) become:\n\\[\n\\mathfrak s' = S_i^{(n-k)} \\mathfrak s\\quad \\mathfrak C' = S_i^{(n-k)} \\mathfrak C S_i^{(k)}\n\\]\nThe feasibility and nonivasibility condition, for a given choice of \\(S_i\\) read:\n\\[\n\\begin{cases}\ny' = S_i^{(k)} (-\\mathfrak A^{-1}\\mathfrak r) &gt; 0_{\\|k\\|}\\\\\nD(z)^{-1} z =S_i^{(n-k)}(\\mathfrak s + \\mathfrak C y') &lt; 0_{\\|n-k\\|}\\\\\n\\end{cases}\n\\]\nThere is only one choice out of \\(2^{\\|k\\|}\\) that makes \\(y' &gt; 0_{\\|k\\|}\\); moreover, there is only one choice of \\(S_i^{(n-k)}\\) that fulfills the noninvasibility condition, out of \\(2^{\\|n-k\\|}\\) equiprobable choices. Then, we have that the probability of finding exactly \\(\\|k\\|\\) populations coexisting at the saturated equilibrium, with the remaining \\(\\|n-k\\|\\) that cannot invade is exactly \\(1/(2^{\\|k\\|} \\cdot 2^{\\|n-k\\|}) = 1/2^n\\). The number of coexisting populations at the saturated equilibrium follows the binomial distribution:\n\\[\np(\\|k\\| | n) = \\binom{n}{\\|k\\|} \\frac{1}{2^n}\\quad \\|k\\| \\sim \\mathcal B\\left(n, \\frac{1}{2}\\right)\n\\]\nexactly as for the non-interacting case.\n\n\n\nWe have seen above that in a (stable) GLV model with random interactions, the expected number of species coexisting is proportional to the size of the initial pool: \\(\\mathbb E(\\|k\\|) = n/2\\). We start the system with all the populations present, and we assemble a final community from the top-down. Interestingly, this type of experiment is carried out with increasing frequency in microbial ecology, where a microbial community taken from a certain environment is challenged with a new synthetic environment in the laboratory. For example, Leonora Bittleston and colleagues extracted the microbial communities inhabiting 10 distinct pitcher plants, and cultured them in synthetic media in the laboratory for two months. They plot the number of microbial strains present at the beginning of the experiment (Day 3, such that the strains that cannot grow in the medium are filtered out) and after two months (Day 63), finding a striking linear relationship between the initial size \\(n\\) and that at the end of the experiment \\(\\|k\\|\\):"
  },
  {
    "objectID": "lecture_2.html#all-species-growing-logistically",
    "href": "lecture_2.html#all-species-growing-logistically",
    "title": "GLV with random parameters",
    "section": "",
    "text": "Suppose we take \\(n\\) populations, each growing according to:\n\\[\n\\dot{x}_i = x_i (r_i - A_{ii} x_i)\n\\]\nwith \\(A_{ii} &gt; 0\\). We assume that the growth rates are sampled independently from a distribution: \\(r_i \\sim Q\\), a distribution with mean \\(0\\), \\(\\mathbb E(r_i) = 0\\) and symmetric about its mean, such that \\(\\phi(r_i) = \\phi(-r_i)\\), where \\(\\phi(\\cdot)\\) is the p.d.f. of distribution \\(Q\\). For example, we could choose \\(r_i \\sim \\mathcal N(0, \\sigma^2)\\), or \\(r_i \\sim \\mathcal U[-1, 1]\\). Naturally, whenever \\(r_i &gt; 0\\), the population will grow to \\(x_i^\\star = r_i / A_{ii}\\). If \\(r_i &lt; 0\\), on the other hand, the population will go extinct. Because of the symmetry around zero, each population has therefore probability \\(1/2\\) of persisting. When we have \\(n\\) populations, the number of coexisting populations \\(\\|k\\|\\) is a random variable following the binomial distribution:\n\\[\np(\\|k\\| | n) = \\binom{n}{\\|k\\|} \\frac{1}{2^n}\\quad \\|k\\| \\sim \\mathcal B\\left(n, \\frac{1}{2}\\right)\n\\]"
  },
  {
    "objectID": "lecture_2.html#the-random-zoo",
    "href": "lecture_2.html#the-random-zoo",
    "title": "GLV with random parameters",
    "section": "",
    "text": "Now consider a GLV model with random parameters. We choose \\(r_i\\) from a distribution with mean zero and symmetric about the mean, and each interaction \\(A_{ij}\\) from a distribution with mean zero and symmetric about the mean. Moreover, we add a constant to the diagonal of the matrix such that the symmetric part of \\(A\\), \\(H(A) = \\frac{1}{2} (A + A^T)\\) is positive definite. As we have seen before, this means that dynamics will always converge to a saturated equilibrium.\nWe now introduce a family of \\(2^n\\) matrices \\(S_i\\), with:\n\\[\n\\begin{aligned}\nS_1 &= \\begin{pmatrix}\n1 & 0 & 0 & \\cdots & 0\\\\\n0 & 1 & 0 & \\cdots & 0\\\\\n0 & 0 & 0 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} = I_n\\\\\nS_2 &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & 1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} \\\\\nS_3 &= \\begin{pmatrix}\n1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} \\\\\nS_4 &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix}\\\\\n\\vdots\\\\\nS_{2^n} &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & -1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &-1\n\\end{pmatrix} = -I_n\\\\\n\\end{aligned}\n\\]\nThese matrices, called signature matrices are their own inverse (a matrix with this property is called involutory), and therefore, we have that \\(S_i S_i = S_i^2 = I_n\\). Geometrically, these matrices represent a reflection in each of the axes corresponding to the negated rows or columns.\nWe then consider what happens when we transform the parameters by multiplying them by \\(S_i\\). Take an arbitrary GLV system, and solve for the \\(x\\) that makes \\(r + Ax = 0_n\\):\n\\[\nx = -A^{-1} r\n\\]\nThe vector is a feasible equilibrium for the system if \\(x &gt; 0_n\\). Now consider the transformed system:\n\\[\nr' = S_i r \\quad A' = S_iAS_i\n\\]\nNote that \\(A'\\) is similar to \\(A\\), and therefore has the same eigenvalues; moreover, \\(\\phi(r') = \\phi(r)\\) and \\(\\phi(A') = \\phi(A)\\), because of symmetry. Now compute the new solution\n\\[\n\\begin{aligned}\nx' &= -(S_iAS_i)^{-1} S_i r\\\\ &=-S_iA^{-1}S_i S_i r\\\\\n&=-S_iA^{-1}r\\\\\n&= S_i x\n\\end{aligned}\n\\]\nThat is, the transformation changes the sign of the components of \\(x\\) corresponding to the negative coefficients in \\(S_i\\). Hence, for any possible choice of \\(r\\) and \\(A\\), there is only one possible choice of \\(S_i\\) that makes the equilibrium feasible. Because all matrices \\(A'\\) and all vectors \\(r'\\) have the same probability/density, then the probability of having a positive \\(x\\) is exactly \\(1/2^n\\). Thus, a system with random parameters and a strongly stable matrix of interactions has the same probability of feasibility as that of a system in which populations are not interacting!\nWe have seen that when \\(A\\) is such that \\(H(A)\\) is negative definite, dynamics always converge to a saturated equilibrium. We want to compute the probability of finding a saturated equilibrium, in which populations belonging to set \\(k\\) coexist, and the remaining populations cannot invade when rare.\nWe thus divide \\(x\\), \\(r\\) and \\(A\\) as:\n\\[\nx = \\begin{pmatrix}\ny\\\\\nz\n\\end{pmatrix} \\quad \\tilde{x} = \\begin{pmatrix}\ny^\\star\\\\\n0_{\\|n-k\\|}\n\\end{pmatrix} \\quad A = \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\quad r = \\begin{pmatrix}\n\\mathfrak r\\\\\n\\mathfrak s\n\\end{pmatrix}\n\\]\nWe also divide \\(S_i\\) into:\n\\[\nS_i = \\begin{pmatrix}\nS_{i}^{(k)} & 0_{\\|k\\|, \\|n-k\\|}\\\\\n0_{\\|n-k\\|, \\|n\\|} & S_{i}^{(n-k)}\n\\end{pmatrix}\n\\]\nWhen we use the signature matrix, the vector \\(\\mathfrak s\\) and the matrix \\(\\mathfrak C\\) become:\n\\[\n\\mathfrak s' = S_i^{(n-k)} \\mathfrak s\\quad \\mathfrak C' = S_i^{(n-k)} \\mathfrak C S_i^{(k)}\n\\]\nThe feasibility and nonivasibility condition, for a given choice of \\(S_i\\) read:\n\\[\n\\begin{cases}\ny' = S_i^{(k)} (-\\mathfrak A^{-1}\\mathfrak r) &gt; 0_{\\|k\\|}\\\\\nD(z)^{-1} z =S_i^{(n-k)}(\\mathfrak s + \\mathfrak C y') &lt; 0_{\\|n-k\\|}\\\\\n\\end{cases}\n\\]\nThere is only one choice out of \\(2^{\\|k\\|}\\) that makes \\(y' &gt; 0_{\\|k\\|}\\); moreover, there is only one choice of \\(S_i^{(n-k)}\\) that fulfills the noninvasibility condition, out of \\(2^{\\|n-k\\|}\\) equiprobable choices. Then, we have that the probability of finding exactly \\(\\|k\\|\\) populations coexisting at the saturated equilibrium, with the remaining \\(\\|n-k\\|\\) that cannot invade is exactly \\(1/(2^{\\|k\\|} \\cdot 2^{\\|n-k\\|}) = 1/2^n\\). The number of coexisting populations at the saturated equilibrium follows the binomial distribution:\n\\[\np(\\|k\\| | n) = \\binom{n}{\\|k\\|} \\frac{1}{2^n}\\quad \\|k\\| \\sim \\mathcal B\\left(n, \\frac{1}{2}\\right)\n\\]\nexactly as for the non-interacting case."
  },
  {
    "objectID": "lecture_2.html#random-zoo-and-experimental-data",
    "href": "lecture_2.html#random-zoo-and-experimental-data",
    "title": "GLV with random parameters",
    "section": "",
    "text": "We have seen above that in a (stable) GLV model with random interactions, the expected number of species coexisting is proportional to the size of the initial pool: \\(\\mathbb E(\\|k\\|) = n/2\\). We start the system with all the populations present, and we assemble a final community from the top-down. Interestingly, this type of experiment is carried out with increasing frequency in microbial ecology, where a microbial community taken from a certain environment is challenged with a new synthetic environment in the laboratory. For example, Leonora Bittleston and colleagues extracted the microbial communities inhabiting 10 distinct pitcher plants, and cultured them in synthetic media in the laboratory for two months. They plot the number of microbial strains present at the beginning of the experiment (Day 3, such that the strains that cannot grow in the medium are filtered out) and after two months (Day 63), finding a striking linear relationship between the initial size \\(n\\) and that at the end of the experiment \\(\\|k\\|\\):"
  },
  {
    "objectID": "lecture_2.html#metapopulations",
    "href": "lecture_2.html#metapopulations",
    "title": "GLV with random parameters",
    "section": "Metapopulations",
    "text": "Metapopulations\nIn 1969, Richard Levins—then a professor at U. Chicago—proposed a simple model for a “metapopulation”, i.e., a “population of populations in which local extinctions are balanced by remigration from other populations” (Levins (1969)).\nThe model is very simple. Suppose that there are very many patches of suitable habitat, and that we track the proportion of patches occupied by a certain species, \\(p(t)\\). Two processes affect the proportion of occupied patches: extinction, turning an occupied patch into a vacant patch, and colonization, turning a vacant patch into an occupied patch. For the simplest case, suppose that occupied patches can send “propagules” to empty patches at a fixed rate \\(\\gamma &gt; 0\\), and that the rate at which local populations go extinct is the same for all patches, \\(\\delta &gt; 0\\).\nCall \\(q(t) = 1-p(t)\\) the proportion of vacant patches. Then, the dynamics are described by the equations:\n\\[\n\\begin{cases}\n\\dot{p}(t) = -\\delta p(t) + \\gamma p(t)q(t)\\\\\n\\dot{q}(t) = \\delta p(t) - \\gamma p(t)q(t)\\\\\n\\end{cases}\n\\]\nin which we assume mass-action (like in GLV). Note that the two equations sum to zero (i.e., we’re in a zero-sum setting), and therefore we can substitute \\(q(t) = 1-p(t)\\) to obtain:\n\\[\n\\dot{p} = p(-\\delta + \\gamma q) = p(\\gamma - \\delta - \\gamma p)\n\\]\nwhich is the usual equation for the logistic growth, with growth rate \\(\\gamma - \\delta\\) and self-interaction \\(\\gamma\\). As such, as long as \\(\\gamma &gt; \\delta\\), the proportion of inhabited patches will converge to \\(p^\\star = 1 - \\delta/\\gamma &gt; 0\\), which is globally stable."
  },
  {
    "objectID": "lecture_2.html#colonization-competition-tradeoff",
    "href": "lecture_2.html#colonization-competition-tradeoff",
    "title": "GLV with random parameters",
    "section": "Colonization-competition tradeoff",
    "text": "Colonization-competition tradeoff\nLevins’ model was extended in a number of ways. One of the most interesting cases is that in which we have \\(n\\) species, each characterized by an extinction and a colonization rate, and there is a trade-off such that better colonizers are worse competitors, and vice versa. In particular:\n\n\\(p_i\\) is the proportion of patches occupied by population \\(i\\), with \\(\\sum_j p_j \\leq 1\\)\n\\(m_i\\) is the extinction rate for population \\(i\\)\n\\(c_i\\) is the colonization rate for population \\(i\\)\neach species can colonize patches occupied by inferior competitors (i.e., these patches “look” empty to them)\ncompetitive abilities are inversely related to the colonization rates, i.e., if \\(c_j &lt; c_i\\), then \\(j\\) is a better competitor than \\(i\\)\n\nThe model is a system of \\(n\\) coupled differential equations:\n\\[\n\\dot{p}_i = -m_i p_i - \\sum_{j=1}^{i-1} c_j p_j p_i + c_i p_i \\left(1-\\sum_{j=1}^{i} p_j\\right)\n\\]\nThere are three processes at play:\n\n\\(m_i p_i\\) the rate at which patches occupied by \\(i\\) become empty\n\\(c_j p_j p_i\\) propagules from superior competitors \\(j\\) (produced at rate \\(c_j p_j\\)) reach patches occupied by \\(i &lt; j\\) and turn them over\npropagules of \\(i\\), produced at rate \\(c_i p_i\\), reach patches that are either empty or occupied by inferior competitors (written as the difference between \\(1\\) and the sum of the proportion of patches occupied by species with equal or better competitive abilities, \\(1-\\sum_{j=1}^{i} p_j\\)) and colonize them"
  },
  {
    "objectID": "lecture_2.html#the-model-is-glv",
    "href": "lecture_2.html#the-model-is-glv",
    "title": "GLV with random parameters",
    "section": "The model is GLV",
    "text": "The model is GLV\nWith some rearranging, we can write this model as GLV:\n\\[\n\\begin{aligned}\n\\dot{p}_i &= p_i\\left(-m_i - \\sum_{j=1}^{i-1} c_j p_j + c_i \\left(1-\\sum_{j=1}^{i} p_j\\right)\\right)\\\\\n&= p_i\\left(-m_i - \\sum_{j=1}^{i-1} c_j p_j + c_i - c_i p_i -\\sum_{j=1}^{i-1} c_i p_j \\right)\\\\\n&= p_i\\left(c_i -m_i - c_i p_i -\\sum_{j=1}^{i-1} (c_i + c_j) p_j \\right)\\\\\n&= p_i\\left(r_i - \\sum_{j}A_{ij} p_j\\right)\n\\end{aligned}\n\\] Where we have defined the matrix \\(A\\):\n\\[\nA = \\begin{pmatrix}\nc_1 & 0 & 0 &\\cdots &0\\\\\nc_1 + c_2 & c_2 & 0 & \\cdots & 0\\\\\nc_1 + c_3 & c_2 + c_3 & c_3 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots\\\\\nc_1 + c_n & c_2 + c_n & c_3 + c_n & \\cdots & c_n\n\\end{pmatrix}\n\\]\nand \\(r_i = c_i - m_i\\).\nWe want to show that for each initial set of species in the system, dynamics will converge to a unique saturated equilibrium. To prove this, it is sufficient to find a positive diagonal matrix, \\(D(w)\\) such that\n\\[\nM = D(w) A + A^T D(w)\n\\]\nis positive definite. Take \\(w = c^{-1}\\) (i.e., the reciprocals of the colonization rates). Then we have that\n\\[\nM = 1_n 1_n^T + Q\n\\]\nWhere\n\\[\nQ_{ij} = \\begin{cases}\n1 \\quad \\text{if}\\; j = i\\\\\n\\frac{c_i}{c_j} \\quad \\text{if}\\; j &gt; i\\\\\n\\frac{c_j}{c_i} \\quad \\text{if}\\; j &lt; i\\\\\n\\end{cases}\n\\]\nTo show that \\(M\\) is positive definite, we write the Cholesky decomposition of \\(Q\\)\n\\[\nQ = R^T R\n\\]\nWith\n\\[\nR_{ij} =\n\\begin{cases}\n\\frac{\\sqrt{c_i^2 - c_{i-1}^2}}{c_j}  \\quad \\text{if}\\; j \\geq i\\\\\n0 \\quad \\text{if}\\; j &lt; i\\\\\n\\end{cases}\n\\]\n(defining \\(c_0 = 0\\)). Note that all the elements of \\(R_{ij} \\geq 0\\). As such, \\(Q\\) is positive (semi-)definite, and \\(M\\) is the sum of two positive (semi-)definite matrices, and is thus positive (semi-)definite.\nAn example. Suppose \\(n = 3\\), then:\n\\[\nA = \\begin{pmatrix}\nc_1 & 0 & 0\\\\\nc_1 + c_2 & c_2 & 0\\\\\nc_1 + c_3 & c_2 + c_3 & c_3\n\\end{pmatrix}\n\\] \\[\nM = D(c)^{-1} A + A^T D(c)^{-1}=\\begin{pmatrix}\n2 & 1 + \\frac{c_1}{c_2} & 1 + \\frac{c_1}{c_3}\\\\\n1 + \\frac{c_1}{c_2} &2 & 1 + \\frac{c_2}{c_3}\\\\\n1 + \\frac{c_1}{c_3} & 1 + \\frac{c_2}{c_3} & 2\\\\\n\\end{pmatrix}\n\\] \\[\nQ = \\begin{pmatrix}\n1 & \\frac{c_1}{c_2} & \\frac{c_1}{c_3}\\\\\n\\frac{c_1}{c_2} & 1 & \\frac{c_2}{c_3}\\\\\n\\frac{c_1}{c_3} & \\frac{c_2}{c_3} & 1\\\\\n\\end{pmatrix}\n\\] \\[\nR = \\begin{pmatrix}\n1 & \\frac{c_1}{c_2} & \\frac{c_1}{c_3}\\\\\n0 & \\frac{\\sqrt{c_2^2 - c_1^2}}{c_2} & \\frac{\\sqrt{c_2^2 - c_1^2}}{c_3}\\\\\n0 & 0 & \\frac{\\sqrt{c_3^2 - c_2^2}}{c_3}\n\\end{pmatrix} \\quad Q = R^T R\n\\]"
  },
  {
    "objectID": "lecture_2.html#computing-equilibria",
    "href": "lecture_2.html#computing-equilibria",
    "title": "GLV with random parameters",
    "section": "Computing equilibria",
    "text": "Computing equilibria\nFor simplicity, we are going to consider the case in which \\(m_i = m\\) for all \\(i\\). Because the matrix is lower-triangular, computing the equilibrium is especially simple, given that the equilibrium value for each species depends only on those of the preceding species. The equilibrium of the first species is given by:\n\\[\nc_1 p_1 = c_1 -m\n\\]\nand thus\n\\[\np_1^\\star = \\frac{c_1 - m}{c_1} = 1 - \\frac{m}{c_1}\n\\]\nThe first species follows the Levins’ model, and persists as long as \\(c_1 &gt; m\\). We compute the equilibrium for the second species, assuming that the first species is present:\n\\[\n\\begin{aligned}\n(c_1 + c_2) p_1^\\star + c_2 p_2^\\star = c_2 - m\\\\\n(c_1 + c_2)\\left(1 - \\frac{m}{c_1}\\right) + c_2 p_2^\\star &=  c_2 - m\\\\\nc_1 + c_2 - m - m \\frac{c_2}{c_1} +  c_2 p_2^\\star &=  c_2 - m\\\\\np_2^\\star = \\frac{m}{c_1} - \\frac{c_1}{c_2}\n\\end{aligned}\n\\]\nThus, species 2 can establish if:\n\\[\nc_2 &gt; \\frac{c_1^2}{m}\n\\]\nComputing the equilibrium of the third species we find that it is positive if:\n\\[\nc_3 &gt; \\frac{c_2^2}{\\frac{c_1^2}{m}}\n\\]\nYou can see that there is a simple pattern. Call \\(l_0 = m\\), then the condition for the first species to persist is that \\(c_1 &gt; l_0\\); second species to persist whenever \\(c_2 &gt; c_1^2 / l_0 = l_1\\); the third species persists whenever \\(c_3 &gt; c_2^2 / l_1\\), and so forth:\n\\[\nl_i = \\frac{c_i^2}{l_{i-1}}\n\\]\nThis value represents the “shadow” each species that establishes casts on the colonization axis. A worse competitor \\(i + 1\\) can establish if and only if:\n\\[\nc_{i+1} &gt; l_i\n\\]\nThus, if the species has a sufficiently large colonization rate, it will establish; if not, it will go extinct. In this way, we can compute the set of coexisting species in linear time (i.e., without the need to invert the matrix)."
  },
  {
    "objectID": "lecture_2.html#random-parameters",
    "href": "lecture_2.html#random-parameters",
    "title": "GLV with random parameters",
    "section": "Random parameters",
    "text": "Random parameters\nSample the colonization rate values indipendently from a distribution (with positive support); for example \\(\\gamma_i \\sim \\mathcal U[m,1+m]\\), or from the exponential distribution \\(\\gamma_i \\sim \\mathcal{Exp(\\lambda) + m}\\) (we sample values above the mortality rate—any lower value for the colonization rate would lead to extinction). Then sort them and assign the smallest value to species 1 (\\(c_1 = \\min_i \\gamma_i\\)), the second smallest value to species 2, etc. These are called the order statistics of the distribution.\nHow many species will coexist? Given that the final set of coexisting species can be found in linear time, we can run large experiments in which we compute the number of coexisting species \\(\\|k\\|\\) when starting with \\(n\\) for different sizes \\(n\\) and choice of distribution from which to sample the colonization rates.\n\n\n\n\n\nWe can see that as \\(n\\) increases, the distribution of \\(\\|k\\|\\) approaches the binomial distribution (plotted in red)—to be precise, given that the first species persists by definition (because \\(c_1 &gt; m\\) by design), we have that asymptotically \\(\\|k\\|-1 \\sim \\mathcal B(n-1, \\frac{1}{2})\\), irrespective of the distribution used to sample the colonization rates. Therefore, as \\(n \\to \\infty\\), the distribution of surviving species is universal."
  },
  {
    "objectID": "lecture_2.html#sketch-of-the-proof",
    "href": "lecture_2.html#sketch-of-the-proof",
    "title": "GLV with random parameters",
    "section": "Sketch of the proof",
    "text": "Sketch of the proof\nThe argument to support these claims is a little too complicated for the time that we have available. To give a sense of how the argument is developed, we show that the probability that \\(\\|k\\|=1\\) is about \\(1/2^{(n-1)}\\) when we sample the colonization rates from the uniform distribution \\(\\mathcal U[m, m+1]\\).\nWe can write the joint distribution for \\((c_1, c_n)\\) (i.e., the smallest and largest colonization rate) for an arbitrary (absolutely continuous) distribution, from which we extract \\(n\\) colonization rates as:\n\\[\nf(c_1,c_n) = n(n-1) (\\Phi(c_n)-\\Phi(c_1))^{(n-2)} \\phi(c_1) \\phi(c_n)\n\\]\nwhere \\(\\phi(\\cdot)\\) is the probability density function for the distribution used to sample the values, and \\(\\Phi(\\cdot)\\) the cumulative density function.\nWhen \\(n\\) is large, we can approximate the “niche shadow” value as follows. We know that species \\(j\\) is excluded if \\(c_i &lt; c_j &lt; l_i\\), where \\(l_i\\) is the niche shadow cast by species \\(i\\):\n\\[\nl_i = \\frac{c_i^2}{l_{i-1}}\n\\]\nThus, to be included in the set of coexisting species, we need \\(c_j &gt; l_i\\). We introduce \\(X_i\\), the amount by which \\(c_j\\) exceeds \\(l_{i-1}\\):\n\\[\nX_i = c_i - l_{i-1}\n\\]\nThen, we have\n\\[\nl_i = \\frac{(l_{i-1} + X_i)^2}{l_{i-1}} = l_{i-1} + 2 X_i +\\frac{X_i^2}{l_{i-1}} \\approx l_{i-1} + 2 X_i = 2 c_i - l_{i-1}\n\\]\nwhere we have neglected the term \\(X_i^2 / l_{i-1}\\), which is small when \\(n\\) is large (because the colonization values are closer together).\nWe now can compute the probability that species \\(1\\) excludes all other species, assuming that the niche shadow cast by species 1 is \\(\\approx 2 c_1 -m\\). We need to distinguish between two cases: a) the shadow cast by species 1 does not exceed the upper bound for the distribution (\\(m+1\\) in this case) and all other colonization rates fall into \\((c_1, 2 c_1 - m)\\), and b) the shadow cast by species 1 exceeds the bound, and thus all other species are excluded by definition.\nThe niche shadow for the first species, \\(l_1 \\approx 2 c_1 - m\\) does not exceed \\(m+1\\) whenever \\(c_1 \\leq m + 1/2\\). We thus compute the probability that i) \\(c_1 \\leq m + 1/2\\), and ii) \\(c_n \\leq 2 c_1 -m\\) for the uniform distribution, using:\n\\[\n\\phi(z) = 1\\quad \\Phi(z) = z -m\n\\]\nThe density for \\((c_1,c_n)\\) simplifies to:\n\\[\nf(c_1,c_n) = n(n-1) (c_n - c_1)^{(n-2)}\n\\]\nand we need to integrate this function for:\n\\[\nn(n-1)\\int_{m}^{m + 1/2} \\int_{c_1}^{2c_1 - m}(c_n-c_1)^{(n-2)} dc_1 dc_n = 2^{-n}\n\\] Now we treat the case in which \\(c_1\\) exceeds \\(m + 1/2\\), and \\(c_1 \\leq c_n \\leq m+1\\):\n\\[\nn(n-1)\\int_{m+1/2}^{m + 1} \\int_{c_1}^{m+1}(c_n-c_1)^{(n-2)} dc_1 dc_n = 2^{-n}\n\\]\nSumming the two mutually-exclusive outcomes, we find\n\\[\nP(\\|k\\| = 1) = 2^{-n} + 2^{-n} = 2^{-n+1}\n\\]\nconsistently with the asymptotic distribution \\(\\|k\\|-1 \\sim \\mathcal B(n-1, 1/2)\\). This approach can be extended by computing the probability that a given species \\(i\\) excludes \\(\\kappa_i\\) other species; by summing across all combinations we can approximate the distribution of coexisting species (see Miller et al., SI section B)."
  },
  {
    "objectID": "lecture_2.html#references-and-further-readings",
    "href": "lecture_2.html#references-and-further-readings",
    "title": "GLV with random parameters",
    "section": "References and further readings",
    "text": "References and further readings\nCoexistence in GLV with random parameters and stable interaction matrix\n\nServán, C.A., Capitán, J.A., Grilli, J., Morrison, K.E. and Allesina, S., 2018. Coexistence of many species in random ecosystems. Nature ecology & evolution, 2(8), pp.1237-1242.\n\nExperiment on pitcher plant microbial communities\n\nBittleston, L.S., Gralka, M., Leventhal, G.E., Mizrahi, I. and Cordero, O.X., 2020. Context-dependent dynamics lead to the assembly of functionally distinct microbial communities. Nature communications, 11(1), p.1440.\n\nThe original metapopulation model:\n\nLevins, R., 1969. Some demographic and genetic consequences of environmental heterogeneity for biological control. Bulletin of the ESA, 15(3), pp.237-240.\n\nMany authors contributed to the study of the model with competition-colonization tradeoff:\n\nHastings, A., 1980. Disturbance, coexistence, history, and competition for space. Theoretical population biology, 18(3), pp.363-373.\n\nderived the model by extending Levins’ model to \\(n\\) populations. Noted that better competitors need to be poor colonizers to yield coexistence.\n\nTilman, D., 1994. Competition and biodiversity in spatially structured habitats. Ecology, 75(1), pp.2-16.\n\nperformed a thorough analysis of the model, inspired by data on grasslands as well as life-history theory. Noted that infinitely many species could coexist, and derived conditions for limiting similarity.\n\nNowak, M.A. and May, R.M., 1994. Superinfection and the evolution of parasite virulence. Proceedings of the Royal Society of London. Series B: Biological Sciences, 255(1342), pp.81-89.\n\nderived the model in the context of superinfection (better pathogens displace others in infected individuals). Showed that this would lead to the coexistence of pathogens of different virulence, rather than convergence to an optimum.\n\nKinzig, A.P., Levin, S.A., Dushoff, J. and Pacala, S., 1999. Limiting similarity, species packing, and system stability for hierarchical competition-colonization models. The American Naturalist, 153(4), pp.371-383.\n\nstudied the model in the high-diversity limit. Highlighted pathological behaviors of the model. Provided a construction to pack infinitely many species in a finite interval of colonization rates (requires fine-tuning).\n\nMiller, Z.R., Clenet, M., Della Libera, K., Massol, F. and Allesina, S., 2024. Coexistence of many species under a random competition–colonization trade-off. Proceedings of the National Academy of Sciences, 121(5), p.e2314215121.\n\ncontains the derivations presented here, and much more."
  },
  {
    "objectID": "lecture_1.html",
    "href": "lecture_1.html",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "Alfred J. Lotka (1880-1949) was born to French-speaking American parents in Lemberg (then part of the Habsburg empire, now Lviv, Ukraine). He studied in France, Germany and England, receiving a BSc in 1901 and a DSc in 1912 from Birmingham university. He moved to the US in 1902, and worked at the US Patent office, as an editor of Scientific American, and as a statistician at the Metropolitan Life Insturance Company in NYC. He wrote more than a hundred papers and five books, spanning a wide range of topics. He’s best known for the book Elements of Physical Biology, his contributions to demography, and one of the first studies dealing with bibliometrics.\nStarting in 1910, he investigated coupled differential equations relating to chemical as well as ecological dynamics. In 1920 he studied a system of two ODEs that gave rise to perpetual oscillations: “It was, therefore, with considerable surprise that the writer, on applying his method to certain special cases, found these to lead to undamped, and hence indefinitely continued, oscillations.” He went on to describe “1. A species of organism \\(S_1\\), a plant species, say, deriving its nourishment from a source presented in such large excess that the mass of the source may be considered constant during the period of time with which we are concerned. 2. A species \\(S_2\\), for example a herbivorous animal species, feeding on \\(S_1\\).”\nThe equations he had derived (and then studied in more detail) are now called Lotka-Volterra equations.\n\n\n\n\n\nVito Volterra (1860-1940) was born in Ancona (then part of the Papal State) in a poor Jewish family. The financial situation precipitated with the death of his father, when Vito was two. Vito and his mother went to live with relatives in Turin and then Florence. Volterra showed amazing mathematical talent at a very young age. Antonio Roiti, professor of physics in Florence, noticed the budding mathematician and hired him as his assistant, so that he could continue his studies. He went on to enroll at the Scuola Normale in Pisa, receiving a degree in Physics in 1882. At age 23 he was made full professor of Rational Mechanics in Pisa, and then in 1900 of Mathematical Physics in Rome. For thirty years, he contributed important studies in mathematics, and enriched academic life in Italy (for example, he was the first director of the National Center for Research). In 1931 he refused to take an oath of loyalty to the fascist regime (only 12 professors out of 1250 refused), and was therefore forced to resign (his take on the fascist enterprise: “Empires die, but Euclid’s theorems keep their youth forever”).\nHis interest in mathematical ecology is due to Umberto D’Ancona (his son-in-law), who had studied the trends in fisheries in the Adriatic sea before and immediately after WWI. In 1914-1918 fisheries in the Adriatic had stopped completely because of the conflict. D’Ancona had noticed that, while herbivorous fish had remained about constant, the piscivorous fish had increased dramatically in number. The problem piqued Volterra, who immediately published a sophisticated study, proposing the same equations studied by Lotka. In a short letter to Nature 1926, he stated the so-called “Volterra’s Effect” (which he termed “Law III”): “a complete closure of the fishery was a form of ‘protection’ under which the voracious fishes were much the better and prospered accordingly, but the ordinary food-fishes, on which these are accustomed to prey, were worse off than before.” This brief paper was a summary of a much more extensive study published in Italian.\n\n\nIn 1927, Lotka wrote to Nature to raise the issue that the equations studied by Volterra and the figures presented in Volterra’s brief article were identical to those found in Elements of Physical Biology (published in 1925). He concluded: “It would be gratifying if Prof. Volterra’s publication should direct attention to a field and method of inquiry which apparently has hitherto passed almost unnoticed.”\nVolterra graciously conceded “I recognize his priority, and am sorry not to have known his work, and therefore not have been able to mention it.” He however listed a few points in which the two authors had pursued different directions, and concluded “Working independently the one from the other, we have found some common results, and this confirms the exactitude and the interest in the position of the problem. I agree with him in his conclusions that these studies and these methods of research deserve to receive greated attention from scholars, and should give rise to important applications.”\n Vito Volterra and Umberto D’Ancona explore the Lotka-Volterra model. Taken from the fantastic La funzione del mondo, a graphic novel on Volterra by Bilotta and Grillotti.\n\n\n\n\nWe can write the GLV model for \\(n\\) interacting populations in component form as:\n\\[\n\\dfrac{d x_i(t)}{dt} = \\dot{x}_i = x_i \\left(r_i + \\sum_j A_{ij} x_j \\right)\n\\]\nand in matrix form as:\n\\[\n\\dot{x} = D(x) \\left(r + Ax \\right)\n\\]\nwhere \\(x = x(t)\\) is a (column) vector of length \\(n\\) containing the densities of all populations \\(1, \\ldots, n\\) at time \\(t\\), \\(r\\) is a vector of intrinsic growth rates (or death rates, when negative), measuring the growth (decline) of population \\(i\\) when growing alone at low density, and \\(A\\) is a \\(n \\times n\\) matrix of interaction coefficients. We use \\(D(x)\\) to denote the diagonal matrix with \\(x\\) on the diagonal.\nSometimes the model is written in a slightly different way, by bringing the vector \\(r\\) outside the parenthesis:\n\\[\n\\begin{aligned}\n\\dot{x}_i &= x_i \\left(r_i + \\sum_j A_{ij} x_j \\right)\\\\\n&= r_i x_i \\left(1 + \\frac{1}{r_i} \\sum_j A_{ij} x_j\\right)\\\\\n&= r_i x_i \\left(1 + \\sum_j B_{ij} x_j\\right)\\\\\n\\end{aligned}\n\\]\nwhere we have defined \\(B_{ij} = A_{ij} / r_i\\). In matrix form, we obtain:\n\\[\n\\dot{x} = D(x \\circ r) \\left(1_n + Bx \\right)\n\\]\nwhere \\(\\circ\\) is the Hadamard (element by element) product. This notation is convenient when computing the equilibria of the system; the previous notation is more convenient when investigating their stability. We will alternate between the two notations, using \\(A\\) and \\(B = D(r)^{-1} A\\) for the two matrices.\n\n\n\nIf an equilibrium \\(x^\\star\\) in which all populations are present exists, it must be the solution of\n\\[\n\\begin{aligned}\n1_n + Bx^\\star &= 0_n\\\\\nBx^\\star &= - 1_n\\\\\nx^\\star &= -B^{-1} 1_n\n\\end{aligned}\n\\]\nwhen the matrix \\(B\\) is invertible. Naturally, the equilibrium must be positive (called feasible) to be biologically attainable.\nFor example, consider:\n\\[\nA = \\begin{pmatrix}\n-4 & -1 & -3\\\\\n-14 & -8 & -10\\\\\n-6 & -15 & -13\n\\end{pmatrix} \\quad r = \\begin{pmatrix}\n8\\\\\n32\\\\\n34\n\\end{pmatrix}\\quad B = D(r)^{-1}A = \\begin{pmatrix}\n-\\frac{1}{2} & -\\frac{1}{8} & -\\frac{3}{8}\\\\\n-\\frac{7}{16} & -\\frac{1}{4} & -\\frac{5}{16}\\\\\n-\\frac{3}{17} & -\\frac{15}{34} & -\\frac{13}{34}\n\\end{pmatrix}\n\\] There is an equilibrium when at which all populations are present:\n\\[\nx^\\star = -A^{-1} r = -B^{-1}1_n = \\begin{pmatrix}\n1\\\\\n1\\\\\n1\n\\end{pmatrix}\n\\] If the matrix \\(B\\) is rank-deficient (and thus singular) there are infinitely many equilibria; for example, if the rank of \\(B\\) is \\(n-1\\) there are infinitely many equilibria belonging to a line in \\(\\mathbb R^n\\).\nWhen \\(B\\) is nonsingular, the model admits at most one positive equilibrium in which all populations are present. However, there can be up to \\(2^n-1\\) equilibria in which one or more populations are absent/extinct. Call \\(B^{(k,k)}\\) the submatrix of \\(B\\) obtained by retaining the rows and columns indexed by the set \\(k\\). Then by solving\n\\[\nB^{(k,k)} x^{(k)\\star} = -1_{\\|k\\|}\n\\]\nwe obtain an equilibrium for the subcommunity where only the populations in \\(k\\) are present (provided that the equilibrium is feasibile).\nFor the example above, we have:\n\\[\nB^{(\\{1,2\\},\\{1,2\\})} = \\begin{pmatrix}\n-\\frac{1}{2}& -\\frac{1}{8}\\\\\n-\\frac{7}{16} & -\\frac{1}{4}\n\\end{pmatrix}\n\\]\nand\n\\[\nx^{(\\{1,2\\})\\star} = -(B^{(\\{1,2\\},\\{1,2\\})})^{-1}1_2=\\begin{pmatrix}\n\\frac{16}{9}\\\\\n\\frac{8}{9}\n\\end{pmatrix}\n\\]\nTherefore, the subsystem in which only the first two populations are present yields a feasible equilibrium.\nSimilarly,\n\\[\nx^{(\\{1,3\\})\\star} = \\begin{pmatrix}\n\\frac{1}{17}\\\\\n\\frac{44}{17}\n\\end{pmatrix} \\quad x^{(\\{1\\})\\star} = \\begin{pmatrix}\n2\\\\\n\\end{pmatrix} \\quad x^{(\\{2\\})\\star} = \\begin{pmatrix}\n4\\\\\n\\end{pmatrix} \\quad x^{(\\{3\\})\\star} = \\begin{pmatrix}\n\\frac{34}{13}\\\\\n\\end{pmatrix}\n\\]\nThe subsystem in which only populations 2 and 3 are present does not yield a feasible equilibrium.\n\n\n\nFor a single population, the GLV model can yield only two outcomes: unbounded growth, or convergence to an equilibrium; if the equilibrium is \\(x^\\star = 0\\), we say that the population is extinct at the equilibrium.\n\n\n\n\n\nWhen we have two populations, we can also observe neutral cycles (as in the classic LV predator-prey system), and bistability (i.e., one population survives, while the other goes extinct; the identity of the population going extinct depends on the initial conditions).\n\n\n\n\n\nFor three populations we can observe limit cycles.\n\n\n\n\n\nFor three or more populations (in the general case), or four or more populations (in competitive systems), we can have chaos (i.e., non-periodic oscillations).\n\n\n\n\n\n\n\n\nSuppose that \\(x(t)\\) has a periodic orbit, of period \\(T\\) (i.e., we assume \\(x(0) = x(T)\\)). Further, assume that the GLV has a feasible, interior equilibrium \\(x^\\star\\). We want to calculate the average density for each population:\n\\[\n\\frac{1}{T} \\int_0^T x(t) dt\n\\]\nFirst, we assume that \\(x(t) &gt; 0\\) and write the dynamics of its logarithm:\n\\[\n\\dfrac{d \\log(x_i(t))}{dt} = \\dfrac{1}{x_i(t)}\\dfrac{d x_i(t)}{dt} = r_i + \\sum_j A_{ij} x_j(t)\n\\]\nIn vector form:\n\\[\n\\dfrac{d \\log{x(t)}}{dt}= r + A x(t)\n\\]\nCompute the average on both sides:\n\\[\n\\frac{1}{T}\\int_0^T \\frac{d \\log(x(t))}{dt} dt= \\frac{1}{T}\\int_0^T \\left(r + Ax(t) \\right) dt\n\\]\nyielding:\n\\[\n\\frac{1}{T}(\\log(x(T)) - \\log(x(0))) = 0_n = r + A \\left( \\frac{1}{T} \\int_0^T x(t) dt \\right)\n\\]\nNote that the l.h.s. is zero because \\(x(0) = x(T)\\). Now rearrange:\n\\[\n-r = A \\left( \\frac{1}{T} \\int_0^T x(t) dt \\right)\n\\]\nMultiplying by the matrix inverse:\n\\[\n-A^{-1} r = x^\\star =  \\frac{1}{T} \\int_0^T x(t) dt\n\\]\nshowing that the average density is in fact the equilibrium. With a similar argument, one can prove that if the trajectory stays in a compact space (i.e., in case of chaotic attractors), then the long-time average is still \\(x^\\star\\).\n\n\n\n\n\nSemi-transparent lines: trajectories; dashed lines: equilibrium values; solid line: (cumulative) average of trajectory.\n\n\n\n\n\n\n\nA necessary condition for the coexistence of populations is the existence of a positive (feasible) equilibrium.\n\n\n\n\n\n\nFarkas’ lemma\n\n\n\n\n\nConsider matrix \\(A\\), of size \\(n \\times n\\), and the vector \\(b\\), of length \\(n\\).\nThen either:\n\\[\n\\exists x \\geq 0_n \\quad \\mid \\quad Ax = b\n\\]\nor:\n\\[\n\\exists y \\in \\mathbb R^n \\quad \\mid \\quad A^T y \\geq 0 \\;\\text{and}\\; b^T y &lt; 0\n\\]\n\n\n\nSuppose that the system does not have a feasible equilibrium, i.e., an \\(x^\\star &gt; 0_n\\) such that \\(Ax^\\star = -r\\). Then, there must exist a \\(y\\) such that \\(A^T y \\geq 0_n\\) and \\(r^T y &gt; 0\\).\nBut then, consider the function:\n\\[\nP = \\prod_i x_i^{y_i}\n\\]\nThe function is positive when all \\(x_i &gt; 0\\). Differentiating with respect to time, we find:\n\\[\n\\begin{aligned}\n\\dot{P} &= \\sum_i\\left( y_i \\dot{x}_i x_i^{y_i - 1} \\prod_{j \\neq i} x_j^{y_j} \\right)\\\\\n&=\\sum_i\\left( y_i \\frac{\\dot{x}_i}{x_i} \\prod_{j} x_j^{y_j} \\right)\\\\\n&= P \\sum_i y_i \\left(r_i + \\sum_j A_{ij} x_j\\right)\\\\\n&= P (y^T r + y^T A x)\n\\end{aligned}\n\\]\nbut by Farkas’ lemma, we have that \\(y^T r &gt; 0\\) and \\(y^TA \\geq 0_n^T\\); then \\(P\\) always grows in time, and eventually diverges to \\(\\infty\\).\nNote that \\(P(t) \\to \\infty\\) requires some \\(x_i^{y_i}(t) \\to \\infty\\), which happens when either \\(x_i(t) \\to \\infty\\) and \\(y_i &gt; 0\\) (i.e., a population grows without bound), or \\(x_i(t) \\to 0\\) and \\(y_i &lt; 0\\) (i.e., a population goes extinct). Thus, in the absence of an equilibrium, trajectories can either diverge to infinity, or one or more populations can go extinct.\nA feasible equilibrium is therefore a necessary condition for coexistence.\n\n\n\nWe want to determine whether an equilibrium point is locally asymptotically stable; this means that, for sufficiently small perturbations of the equilibrium, \\(x(0) = x^\\star + \\epsilon\\), we have that \\(\\lim_{t \\to \\infty} x(t) = x^\\star\\). Let’s start by considering the case of a single population:\n\nTake an ODE \\(dx/dt = f(x)\\)\nThe population is resting at an equilibrium \\(x^\\star\\)\nWe perturb the population abundance, and track the dynamics when starting at \\(x(0) = x^\\star + \\epsilon\\), where \\(\\epsilon\\) (the perturbation) is taken to be sufficiently small \\(\\| \\epsilon \\| \\ll 1\\)\nWe write \\(\\Delta x(0) = x(0) - x^\\star\\)\nWe derive the dynamics for \\(\\Delta x\\).\n\nBy chain rule,\n\\[\n\\begin{aligned}\n\\dfrac{d \\Delta x}{dt} &= \\dfrac{d \\Delta x}{dx} \\dfrac{d x}{dt} \\\\\n&= 1 \\dfrac{d x}{dt}\\\\\n&= f(x)\\\\\n&= f(\\Delta x + x^\\star)\n\\end{aligned}\n\\]\nWhere we have substituted \\(x = \\Delta x + x^\\star\\).\n\nNow we approximate the function \\(f(\\Delta x + x^\\star)\\) by Taylor-expanding.\n\n\n\n\n\n\n\nTaylor series\n\n\n\n\n\nWe can approximate the behavior of a (infinitely differentiable) function in the vicinity of a point \\(a\\) by a power series:\n\\[\nf(x) = f(a) + \\dfrac{1}{1!} \\left. \\dfrac{df(x)}{dx} \\right|_a (x-a)+ \\dfrac{1}{2!} \\left. \\dfrac{d^2f(x)}{dx^2} \\right|_a (x-a)^2+ \\dfrac{1}{3!} \\left. \\dfrac{d^3f(x)}{dx^3} \\right|_a (x-a)^3 + \\ldots\n\\]\nwhere \\(n! = n (n-1)(n-2)\\ldots 1\\) is the factorial function and the derivatives are evaluated at \\(a\\). When we choose \\(a=0\\), this is called the Maclaurin series.\nExample\nExpand \\(e^x\\) around \\(0\\):\n\\[\n\\begin{aligned}\ne^x &= e^0 + \\left. e^x\\right|_0 x + \\frac{1}{2}\\left. e^x\\right|_0 x^2  + \\frac{1}{6}\\left. e^x\\right|_0 x^3 + \\ldots\\\\\n&=1 + x + \\frac{1}{2} x^2  + \\frac{1}{6}x^3 + \\ldots\\\\\n&=\\sum_{k=0}^\\infty \\frac{x^k}{k!}\n\\end{aligned}\n\\]\n\n\n\nWe want to Taylor-expand \\(f(x) = f(\\Delta x + x^\\star)\\) around \\(x^\\star\\):\n\\[\nf(x) = f(x^\\star) + \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} (x - x^\\star) + \\dfrac{1}{2}\\left.\\dfrac{d^2 f(x)}{d x^2}\\right|_{x^\\star} (x - x^\\star)^2 + \\ldots\n\\]\nNote that \\(f(x^\\star) = 0\\) by the definition of an equilibrium. If the deviation is small, we can neglect all the higher-order terms, obtaining:\n\\[\n\\dfrac{d \\Delta x}{dt} = f(x) \\approx \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} \\Delta x\n\\]\nwhich is the equation of the exponential growth model, with \\(\\rho = \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star}\\). Then, the solution is \\(\\Delta x(t) = \\Delta x(0) e^{\\rho t}\\), and the deviation from the equilibrium eventually reaches zero (i.e., the system goes back to \\(x^\\star\\)) whenever \\(\\rho &lt; 0\\).\nFor example, take the logistic growth model \\(\\dot{x} = x(1-x)\\), and evaluate the stability of \\(x^\\star = 1\\); we have:\n\\[\n\\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} = \\left.\\dfrac{d (x - x^2)}{d x}\\right|_{x^\\star} = \\left.(1 - 2x)\\right|_{x^\\star} = -1\n\\]\nand thus the equilibrium is locally asymptotically stable. Locally, because we have considered very small deviations from the equilibrium, and asymptotic because convergence only happens eventually.\nIn analogy with the Taylor-expansion of functions of a single variable, we can write:\n\\[\nf_i(x^\\star + \\Delta x) = f_i(x^\\star) + \\sum_k \\left. \\dfrac{\\partial f_i(x)}{\\partial x_k} \\right|_{x^\\star} \\Delta x_k + \\dfrac{1}{2} \\sum_{k}\\sum_{l} \\left. \\dfrac{\\partial^2 f_i(x)}{\\partial x_k \\partial x_l} \\right|_{x^\\star} \\Delta x_k \\Delta x_l + \\cdots\n\\]\nAs before, \\(f_i(x^\\star) = 0\\), and if we take only the second term (i.e., the term linear in \\(\\Delta x\\)) we can approximate the function as:\n\\[\nf_i(x^\\star + \\Delta x) \\approx \\sum_k \\left. J_{ik} \\right|_{x^\\star} \\Delta x_k\n\\]\nWhere we have defined the Jacobian matrix \\(J\\):\n\\[\nJ_{ij} = \\dfrac{\\partial f_i(x)}{\\partial x_j}\n\\]\nFor each equilibrium of the system, we can obtain a different community matrix (the name is due to Richard Levins) \\(M\\):\n\\[\nM = \\left. J \\right|_{x^\\star}\n\\]\nAs such, a system of ODEs has a single Jacobian, and as many community matrices as there are equilibria. As before, we assume that we have slightly perturbed the system at equilibrium, \\(x(t) = x^\\star + \\Delta x\\), where \\(\\Delta x\\) is assumed to be small, and then we approximate the dynamics:\n\\[\n\\dfrac{d\\Delta x}{dt} \\approx \\left. J \\right|_{x^\\star} \\Delta x\n\\]\ni.e., we need to solve a linear system of ODEs.\n\n\n\n\n\n\nSolving systems of linear ODEs\n\n\n\n\n\nConsider the system of first-order, autonomous ODEs:\n\\[\n\\dfrac{dx}{dt} = Ax\n\\]\nIf the matrix \\(A\\) is diagonalizable, we can decompose the matrix as:\n\\[\nA = Q \\Lambda Q^{-1}\n\\]\nWe define a new system of equations, by changing the variables:\n\\[\ny = Q^{-1}x\\quad x = Q y\n\\]\nThen, by chain rule:\n\\[\n\\dfrac{dy}{dt} = Q^{-1} \\dfrac{d x}{dt} = Q^{-1}Q \\Lambda Q^{-1} x= \\Lambda Q^{-1} x = \\Lambda y\n\\]\nWe have decoupled all equations: now the \\(y_i\\) grow or decline independently of each other.\n\\[\n\\dfrac{dy_i}{dt} = \\lambda_i y_i\n\\]\nThis is in fact the equation for the exponential growth/decay, with solution \\(y_i(t) = y(0) e^{\\lambda_i t}\\).\nWe can bring these solutions back to the original form:\n\\[\ny(t) = e^{\\Lambda t} y(0)\n\\]\nwhere \\(e^{\\Lambda t}\\) is a diagonal matrix:\n\\[\ne^{\\Lambda t}= \\begin{pmatrix}\ne^{\\lambda_1 t} & 0 & \\cdots &0\\\\\n0 & e^{\\lambda_2 t} & \\cdots &0\\\\\n\\cdots & \\cdots & \\cdots & \\cdots\\\\\n0 & 0 & \\cdots & e^{\\lambda_n t}\\\\\n\\end{pmatrix}\n\\]\nThen:\n\\[\nx(t) = Q y(t) = Q e^{\\Lambda t} y(0) = Q e^{\\Lambda t} Q^{-1} x(0)\n\\]\nAllowing to easily compute the solution for any linear systems of ODEs.\nStability of the origin\nSuppose that \\(\\lambda_i\\) is a real, negative number; then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = 0\\). If \\(\\lambda_i\\) is positive, on the other hand, then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = \\infty\\). Thus, if any of the \\(\\lambda_i &gt; 0\\), the system will initially move toward \\(\\infty\\) in the direction specified by the corresponding eigenvector.\nWhenever \\(\\lambda_i\\) is complex (e.g., generically, when \\(A\\) is not symmetric), then we need to consider:\n\\[\ne^{\\alpha t + i \\beta t} = e^{\\alpha t} e^{i \\beta t} = e^{\\alpha t} (\\cos \\beta + i \\sin \\beta )t\n\\]\nwhere we have used Euler’s formula. Importantly, \\((\\cos \\beta + i \\sin \\beta )\\) is bounded, and in fact its real (imaginary) part is \\(\\leq 1\\) (the equation describes a unit circle in the complex plane). Then, \\(\\lim_{t \\to \\infty} e^{\\alpha t + i \\beta t} = 0\\) if \\(\\alpha &lt; 0\\).\nTherefore, the vector \\(0_n\\) is an asymptotically stable equilibrium of the system \\(\\dfrac{dx}{dt} = A x\\) if and only if all the eigenvalues of \\(A\\) have negative real part.\nStability of the origin for \\(A_{2 \\times 2}\\)\nAs we have shown above, the eigenvalues of a \\(2\\times2\\) matrix \\(A\\):\n\\[\nA = \\begin{pmatrix}\na & b\\\\\nc & d\n\\end{pmatrix}\n\\]\nare:\n\\[\n\\lambda = \\dfrac{a + d \\pm \\sqrt{4bc + (a-d)^2}}{2}\n\\]\nWe can rewrite the values as:\n\\[\n\\lambda = \\dfrac{1}{2} \\left(\\text{Tr}A \\pm\\sqrt{\\left(\\text{Tr}A \\right)^2 - 4 \\det A} \\right)\n\\]\nIf the trace is negative, and the determinant positive, then the eigenvalues have negative real part, and thus the origin is stable for the corresponding system of linear ODEs. In fact, knowing the trace and the determinant is in this case sufficient to determine the type of dynamics around equilibrium:\n\n\n\nCharacterizing dynamics using trace and determinant\n\n\n\n\n\nTo probe the local asymptotic stability of the equilibria, we can:\n\nCalculate the Jacobian matrix, \\(J\\)\nPlug in an equilibrium, obtaining the corresponding community matrix \\(M\\)\nCompute the eigenvalues of \\(M\\), \\(\\lambda_i\\)\nIf all the eigenvalues have negative real part, \\(\\Re (\\lambda_i) &lt; 0\\), then the equilibrium is locally asymptotically stable; if any \\(\\Re (\\lambda_i) &gt; 0\\), then the equilibrium is unstable, and there are small perturbations that will amplify (at least initially)\n\nFor the GLV system with equilibrium \\(x^\\star = -A^{-1}r &gt; 0_n\\), we have:\n\\[\nJ_{ii} = \\dfrac{\\partial (r_i x_i + \\sum_j A_{ij} x_i x_j)}{\\partial x_i}  = r_i + \\sum_j A_{ij} x_j + A_{ii} x_i\n\\]\nAt equilibrium, we have:\n\\[\nr_i + \\sum_j A_{ij} x_j^\\star = 0\n\\]\nand therefore\n\\[\nM_{ii} = \\left. J_{ii} \\right|_{x^\\star} = A_{ii} x_i^\\star\n\\]\nSimilarly,\n\\[\nJ_{ii} = \\dfrac{\\partial (r_i x_i + \\sum_j A_{ij} x_i x_j)}{\\partial x_j}  = A_{ij} x_i\n\\]\nand thus\n\\[\nM_{ij} = \\left. J_{ij} \\right|_{x^\\star} = A_{ij} x_i^\\star\n\\]\nPutting them together, we obtain:\n\\[\nM = \\left. J \\right|_{x^\\star} = D(x^\\star)A\n\\]\nand thus the equilibrium is l.a.s. if and only if all of the eigenvalues of \\(D(x^\\star)A\\) have negative real part.\nIf the matrix \\(A\\) is symmetric, any feasible equilibrium is stable if and only if the eigenvalues of \\(A\\) are all negative (i.e., \\(A\\) is negative definite). To prove this, take \\(A = A^T\\) and consider the similarity transformation\n\\[\n\\begin{aligned}\nD(x^\\star)^{-\\frac{1}{2}} D(x^\\star) A D(x^\\star)^{\\frac{1}{2}}\\\\\nD(x^\\star)^{\\frac{1}{2}}  A D(x^\\star)^{\\frac{1}{2}}\\\\\n\\end{aligned}\n\\]\nThe matrices \\(D(x^\\star) A\\) and \\(D(x^\\star)^{\\frac{1}{2}} A D(x^\\star)^{\\frac{1}{2}}\\) are similar, and thus have the same eigenvalues; the matrices \\(A\\) and \\(D(x^\\star)^{\\frac{1}{2}} A D(x^\\star)^{\\frac{1}{2}}\\) are congruent, and thus have the same number of positive, negative and zero eigenvalues by Sylvester’s law of inertia.\nA symmetric matrix is negative definite if all its submatrices obtained by deleting a set of rows and the corresponding columns are negative definite as well. Then, if \\(A = A^T\\) is negative definite, a) a feasible equilibrium is locally stable, and b) for any subsystem, feasibility implies local stability.\nNote that this is generally not the case for nonsymmetric matrices \\(A\\), in which case we could have that \\(A\\) has all eigenvalues with a negative real part, while \\(D(x^\\star)A\\) has some eigenvalues with positive real part (or viceversa). For example, take\n\\[\nA = \\begin{pmatrix}\n-3 & 4 & 0\\\\\n5 & -2 & -2\\\\\n5 & 5 & -3\n\\end{pmatrix} \\quad \\lambda(A) = \\{-7,\\frac{1}{2}(-1 \\pm i \\sqrt{15}) \\}\n\\]\nand the equilibrium \\(x^\\star = (1,1,1/2)^T\\) (obtained for \\(r = (-1, -2, -17/2)\\)); we obtain:\n\\[\nM = D(x^\\star)A = \\begin{pmatrix}\n-3 & 4 & 0\\\\\n5 & -2 & -2\\\\\n\\frac{5}{2} & \\frac{5}{2} & -\\frac{3}{2}\n\\end{pmatrix} \\quad \\lambda(B) = \\{-7,\\frac{1}{4}(1 \\pm i\\sqrt{31}) \\}\n\\]\nThus, the equilibrium is not locally asymptotically stable.\n\n\n\nIn certain models, we can show that whenever all the populations start at a positive value, they will always reach a certain equilibrium \\(x^\\star\\). In this case, we say the equilibrium is globally asymptotically stable.\nBecause solving differential equations is in general very difficult, and in many cases of interest impossible, we employ a proxy function, called a Lyapunov function.\n\n\n\n\n\n\nLyapunov functions\n\n\n\n\n\nWe want to prove that all trajectories originating at \\(x(0) &gt; 0\\) eventually converge to \\(x^\\star\\). If we can find a function \\(V\\) such that:\n\n\\(V(x(t)) \\geq 0\\) for all \\(x(t) &gt; 0\\)\n\\(V(x(t)) = 0\\) if and only if \\(x(t) = x^\\star\\)\n\\(\\dfrac{d V(x(t))}{dt} \\leq 0\\) for all \\(x(t)\\) and\n\\(\\dfrac{d V(x(t))}{dt} = 0\\) if and only if \\(x(t) = x^\\star\\)\n\nthen \\(x^\\star\\) is globally asymptotically stable: all trajectories starting at a positive point will converge to it.\nThe logic of this procedure is to identify a suitable function \\(V\\) that is positive everywhere but at the equilibrium, and is always declining in time; then necessarily the function will eventually reach zero, which is attained only at equilibrium.\nExample\n\\(V(x(t)) = (x(t) - x^\\star)^2\\) is a Lyapunov function for the logistic growth model \\(dx/dt = x(1-x)\\): the model has an equilibrium \\(x^\\star = 1\\) that is globally asymptotically stable.\n\n\\(V(x(t))\\) is always nonnegative, and is zero only at \\(x(t) = x^\\star = 1\\)\nThe derivative of \\(V(x(t))\\) w.r.t. time is:\n\n\\[\n\\begin{aligned}\n\\dfrac{dV(t)}{dt} &= \\dfrac{dV(t)}{dx(t)}\\dfrac{dx(t)}{dt}\\\\\n&= 2(x(t) - x^\\star)\\dfrac{dx(t)}{dt}\\\\\n&=-2(x(t)-1) x(t)(x(t)-1)\\\\\n&=-2 x(t) (x(t)-1)^2 \\leq 0\n\\end{aligned}\n\\]\n\n\n\nThere are two classic candidate Lyapunov functions for Lotka-Volterra models. The first is due to MacArthur, and shows that, when interactions are symmetric and the matrix of interactions is negative definite (i.e., has only negative eigenvalues), the feasible equilibrium is globally stable.\nWe consider a slightly modified version of MacArthur’s function, and assume \\(A = A^T\\):\n\\[\nW(x) = r^Tx^\\star - (2 r^T x + x^T A x)\n\\]\nWhenever \\(A\\) is negative definite, then \\(W(x(t))\\) is positive everywhere but at equilibrium (the function is convex), and has a single minimum at the equilibrium. Note that, whenever \\(x^\\star &gt; 0_n\\) is an equilibrium, then\n\\[\n\\begin{aligned}\nr + A x^\\star &= 0_n\\\\\nr &= -Ax^\\star\n\\end{aligned}\n\\]\nSubstitute these values in the function \\(W\\), to obtain:\n\\[\n\\begin{aligned}\nW(x^\\star) &= r^Tx^\\star - (2 r^T x^\\star + (x^\\star)^T A x^\\star) \\\\\n&=r^Tx^\\star - (2 r^T x^\\star + ((x^\\star) A)^T x^\\star)\\\\\n&=r^Tx^\\star - (2 r^T x^\\star -r^T x^\\star)\\\\\n&=0_n\n\\end{aligned}\n\\]\nDifferentiating with respect to time, we find:\n\\[\n\\begin{aligned}\n\\dot{W}(x(t)) &= -(2 r^T \\dot{x} + \\dot{x}^T A x + x^T A \\dot{x})\\\\\n&= -(2 r^T \\dot{x} + \\dot{x}^T A^T x + x^T A \\dot{x})\\\\\n&= -2 (r + Ax)^T \\dot{x}\\\\\n&= -2 (r + Ax)^T D(x) (r + Ax)\\\\\n&=-2 \\sum_i x_i (r_i + (Ax)_i)^2 \\leq 0\n\\end{aligned}\n\\]\nA more general candidate Lyapunov function is due to Goh, and shows that, whenever there exists a positive diagonal matrix \\(D(w)\\) such that \\(D(w)A^T + AD(w)\\) is negative definite, then the equilibrium \\(x^\\star &gt; 0_n\\) is globally stable.\nWe start with the simplest case in which \\(w = 1_n\\) and thus \\(D(w) = I\\). Take the function\n\\[\nV(x(t)) = \\sum_i \\left(x_i - x_i^\\star - x_i^\\star \\log \\frac{x_i}{x_i^\\star} \\right)\n\\]\nThe function is positive for every \\(x \\in \\mathbb {R^n}_+\\), because \\(z - 1 - \\log z \\geq 0\\) whenever \\(z &gt; 0\\); take \\(z = x_i / {x_i}^\\star\\) and then multiply by \\({x_i}^\\star\\) to prove that the function is nonnegative.\nDifferentiating with respect to time, we find:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= \\sum_i \\left(\\dot{x}_i - x_i^\\star \\frac{\\dot{x}_i}{x_i} \\right)\\\\\n&= \\sum_i \\left(x_i (r_i + (Ax)_i) - x_i^\\star (r_i + (Ax)_i)\\right)\\\\\n&=\\sum_i \\Delta x_i (-(Ax^\\star)_i + (Ax)_i )\\\\\n&=\\sum_{i,j}\\Delta x_i A_{ij} \\Delta x_j\\\\\n&=\\Delta x^T A \\Delta x\\\\\n&=\\frac{1}{2}\\Delta x^T (A + A^T)\\Delta x\\\\\n\\end{aligned}\n\\]\nThus, if the symmetric part of \\(A\\), \\(H(A) = \\frac{1}{2} (A + A^T)\\) is negative definite, then \\(\\dot{V}(x(t))&lt;0\\) for every \\(\\Delta x \\neq 0\\) and the equilibrium is stable.\nTo extend the reach of the candidate function, consider the change of variables:\n\\[\nz_i = x_i / w_i \\quad x_i = w_i z_i\n\\]\nwith \\(w_i&gt;0\\). This change of variables cannot impact the existence or stability of equilibria (we are simply changing the units of measure we are using to measure the density of each population). Then,\n\\[\n\\dot{z_i} = \\frac{\\dot{x}_i}{w_i} = \\frac{x_i}{w_i}(r_i + (Ax)_i) = z_i(r_i + (AD(w)z)_i)=z_i(r_i + (\\tilde{A}z)_i)\n\\]\nThus, if \\(H(\\tilde{A}) = \\frac{1}{2} (AD(w) + D(w)A^T)\\) is negative definite, the equilibrium is stable.\n\n\n\nWhen Goh’s function holds, we can prove that dynamics starting from positive conditions \\(x(t)&gt;0_n\\) will converge to a saturated equilibrium \\(\\tilde{x}\\) characterized by two conditions. We have \\(n\\) populations, and at the saturated equilibrium the populations in set \\(k\\) coexist at a globally stable equilibrium, and the remaining populations, belonging to set \\(n-k\\) are extinct, and cannot re-invade the system starting from low abundance.\nWithout loss of generality, we can order the populations such that the first \\(\\|k\\|\\) populations are those that coexist at the saturated equilibrium, and the remaining \\(\\| n- k\\|\\) are those extinct at the saturated equilibrium. We partition all variables according to the two sets:\n\\[\nx = \\begin{pmatrix}\ny\\\\\nz\n\\end{pmatrix} \\quad \\tilde{x} = \\begin{pmatrix}\ny^\\star\\\\\n0_{n-k}\n\\end{pmatrix} \\quad A = \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\quad r = \\begin{pmatrix}\n\\mathfrak r\\\\\n\\mathfrak s\n\\end{pmatrix}\n\\]\nWe consider a minor modification of Goh’s function:\n\\[\nV(x (t)) = \\sum_{i \\in k} \\left(y_i - y_i^\\star - y_i^\\star \\log \\frac{y_i}{y_i^\\star} \\right) +\n\\sum_{i \\in n-k} z_i\n\\]\nDifferentiating with respect to time, we obtain:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= \\sum_{i \\in k} \\left(\\dot{y}_i - y_i^\\star \\frac{\\dot{y}_i}{y_i} \\right)+\\sum_{i \\in n-k} \\dot{z}_i\\\\\n&=\\Delta y^T(\\mathfrak r + \\mathfrak A y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C y+ \\mathfrak D z)\n\\end{aligned}\n\\]\nNow we substitute \\(\\mathfrak r = -\\mathfrak A y^\\star\\), and add and subtract \\(z^T \\mathfrak C y^\\star\\):\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &=\\Delta y^T(-\\mathfrak A y^\\star + \\mathfrak A y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C y+ \\mathfrak D z  + \\mathfrak C y^\\star - \\mathfrak C y^\\star)\\\\\n&=\\Delta y^T(\\mathfrak A \\Delta y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C \\Delta y+ \\mathfrak D z  + \\mathfrak C y^\\star)\n\\end{aligned}\n\\] Now we write the function as the sum of two parts:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= (\\Delta y^T \\mathfrak A \\Delta y + \\Delta y^T \\mathfrak B z + z^T \\mathfrak C \\Delta y + z^T \\mathfrak D z) + z^T(s + \\mathfrak C y^\\star)\\\\\n&= \\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}^T \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}+ z^T(s + \\mathfrak C y^\\star)\\\\\\\\\n&= \\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}^T A\\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}+ z^T(s + \\mathfrak C y^\\star)\\\\\\\\\n\\end{aligned}\n\\]\nWhenever \\(H(A) = \\frac{1}{2}(A + A^T)\\) is negative definite, then the first term is negative for any choice of \\(y\\) and \\(z\\). Examining the second term, we see that \\(\\mathfrak s + \\mathfrak C y^\\star\\) measures the invasion growth rate of the populations in the set \\(n-k\\) when they are attempting to invade the community that is resting at \\(y^\\star\\). Thus, if we can find a saturated equilibrium, it is globally stable and will be reached for any \\(x(0) &gt; 0_n\\).\nThis derivation can be extended by considering a diagonal matrix \\(D(w)\\) with \\(w &gt;0_n\\), as done above.\n\n\n\nA brief paper discussing how to build models in biology:\n\nRichard Levins, 1966. The strategy of model building in population biology. American Scientist 54:421-431\n\nThe Lotka-Volterra predator-prey model was discovered independently by Alfred J. Lotka and Vito Volterra:\n\nAlfred J. Lotka, 1920. Analytical Note on Certain Rhythmic Relations in Organic Systems. PNAS 6 (7) 410-415\nVito Volterra, 1926. Fluctuations in the Abundance of a Species Considered Mathematically. Nature 118:558-60\n\nYou can read their exchange here.\nThe constant of motion that underlies the candidate Lyapunov functions was derived by Lotka in 1920:\n\nAlfred J. Lotka, 1920. Undamped oscillations derived from the law of mass action. Journal of the American Chemical Society 42:1595-1599\n\nVolterra considered many variations, including the competition between species. His results caught the eye of an experimentalist, who validated the principle of competitive exclusion using protozoans:\n\nG.F. Gause, 1934. Experimental Analysis of Vito Volterra’s Mathematical Theory of the Struggle for Existence. Science 79:16-17\n\nThe variety of dynamics displayed by GLV:\n\nSmale, S., 1976. On the differential equations of species in competition. Journal of Mathematical Biology, 3(1), pp.5-7.\nArneodo, A., Coullet, P. and Tresser, C., 1980. Occurence of strange attractors in three-dimensional Volterra equations. Physics Letters A, 79(4), pp.259-263.\nVano, J.A., Wildenberg, J.C., Anderson, M.B., Noel, J.K. and Sprott, J.C., 2006. Chaos in low-dimensional Lotka–Volterra models of competition. Nonlinearity, 19(10), p.2391.\n\nThe paper by MacArthur, on consumer-resource dynamics:\n\nR. MacArthur, 1970. Species packing and competitive equilibrium for many species. Theoretical population biology, 1(1), pp.1-11.\n\nThe paper by B.S. Goh on global stability:\n\nB.S. Goh, 1977. Global stability in many-species systems. The American Naturalist, 111(977), pp.135-143.\n\nThe convergence to saturated equilibria has strong implications for ecological assembly. See for example:\n\nJ. Hofbauer, S.J. Schreiber, 2022. Permanence via invasion graphs: incorporating community assembly into modern coexistence theory. Journal of mathematical biology. Nov;85(5):54.\nC.A. Serván, S. Allesina, 2021. Tractable models of ecological assembly. Ecology Letters May;24(5):1029-37.\n\nI have recently written a paper on Lyapunov functions for GLV that extends and generalizes Goh’s function. Ask me about it if you want to know more!\n\nS. Allesina, 2025. Global stability of ecological and evolutionary dynamics via equivalence. In review"
  },
  {
    "objectID": "lecture_1.html#history",
    "href": "lecture_1.html#history",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "Alfred J. Lotka (1880-1949) was born to French-speaking American parents in Lemberg (then part of the Habsburg empire, now Lviv, Ukraine). He studied in France, Germany and England, receiving a BSc in 1901 and a DSc in 1912 from Birmingham university. He moved to the US in 1902, and worked at the US Patent office, as an editor of Scientific American, and as a statistician at the Metropolitan Life Insturance Company in NYC. He wrote more than a hundred papers and five books, spanning a wide range of topics. He’s best known for the book Elements of Physical Biology, his contributions to demography, and one of the first studies dealing with bibliometrics.\nStarting in 1910, he investigated coupled differential equations relating to chemical as well as ecological dynamics. In 1920 he studied a system of two ODEs that gave rise to perpetual oscillations: “It was, therefore, with considerable surprise that the writer, on applying his method to certain special cases, found these to lead to undamped, and hence indefinitely continued, oscillations.” He went on to describe “1. A species of organism \\(S_1\\), a plant species, say, deriving its nourishment from a source presented in such large excess that the mass of the source may be considered constant during the period of time with which we are concerned. 2. A species \\(S_2\\), for example a herbivorous animal species, feeding on \\(S_1\\).”\nThe equations he had derived (and then studied in more detail) are now called Lotka-Volterra equations.\n\n\n\n\n\nVito Volterra (1860-1940) was born in Ancona (then part of the Papal State) in a poor Jewish family. The financial situation precipitated with the death of his father, when Vito was two. Vito and his mother went to live with relatives in Turin and then Florence. Volterra showed amazing mathematical talent at a very young age. Antonio Roiti, professor of physics in Florence, noticed the budding mathematician and hired him as his assistant, so that he could continue his studies. He went on to enroll at the Scuola Normale in Pisa, receiving a degree in Physics in 1882. At age 23 he was made full professor of Rational Mechanics in Pisa, and then in 1900 of Mathematical Physics in Rome. For thirty years, he contributed important studies in mathematics, and enriched academic life in Italy (for example, he was the first director of the National Center for Research). In 1931 he refused to take an oath of loyalty to the fascist regime (only 12 professors out of 1250 refused), and was therefore forced to resign (his take on the fascist enterprise: “Empires die, but Euclid’s theorems keep their youth forever”).\nHis interest in mathematical ecology is due to Umberto D’Ancona (his son-in-law), who had studied the trends in fisheries in the Adriatic sea before and immediately after WWI. In 1914-1918 fisheries in the Adriatic had stopped completely because of the conflict. D’Ancona had noticed that, while herbivorous fish had remained about constant, the piscivorous fish had increased dramatically in number. The problem piqued Volterra, who immediately published a sophisticated study, proposing the same equations studied by Lotka. In a short letter to Nature 1926, he stated the so-called “Volterra’s Effect” (which he termed “Law III”): “a complete closure of the fishery was a form of ‘protection’ under which the voracious fishes were much the better and prospered accordingly, but the ordinary food-fishes, on which these are accustomed to prey, were worse off than before.” This brief paper was a summary of a much more extensive study published in Italian.\n\n\nIn 1927, Lotka wrote to Nature to raise the issue that the equations studied by Volterra and the figures presented in Volterra’s brief article were identical to those found in Elements of Physical Biology (published in 1925). He concluded: “It would be gratifying if Prof. Volterra’s publication should direct attention to a field and method of inquiry which apparently has hitherto passed almost unnoticed.”\nVolterra graciously conceded “I recognize his priority, and am sorry not to have known his work, and therefore not have been able to mention it.” He however listed a few points in which the two authors had pursued different directions, and concluded “Working independently the one from the other, we have found some common results, and this confirms the exactitude and the interest in the position of the problem. I agree with him in his conclusions that these studies and these methods of research deserve to receive greated attention from scholars, and should give rise to important applications.”\n Vito Volterra and Umberto D’Ancona explore the Lotka-Volterra model. Taken from the fantastic La funzione del mondo, a graphic novel on Volterra by Bilotta and Grillotti."
  },
  {
    "objectID": "lecture_1.html#equations",
    "href": "lecture_1.html#equations",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "We can write the GLV model for \\(n\\) interacting populations in component form as:\n\\[\n\\dfrac{d x_i(t)}{dt} = \\dot{x}_i = x_i \\left(r_i + \\sum_j A_{ij} x_j \\right)\n\\]\nand in matrix form as:\n\\[\n\\dot{x} = D(x) \\left(r + Ax \\right)\n\\]\nwhere \\(x = x(t)\\) is a (column) vector of length \\(n\\) containing the densities of all populations \\(1, \\ldots, n\\) at time \\(t\\), \\(r\\) is a vector of intrinsic growth rates (or death rates, when negative), measuring the growth (decline) of population \\(i\\) when growing alone at low density, and \\(A\\) is a \\(n \\times n\\) matrix of interaction coefficients. We use \\(D(x)\\) to denote the diagonal matrix with \\(x\\) on the diagonal.\nSometimes the model is written in a slightly different way, by bringing the vector \\(r\\) outside the parenthesis:\n\\[\n\\begin{aligned}\n\\dot{x}_i &= x_i \\left(r_i + \\sum_j A_{ij} x_j \\right)\\\\\n&= r_i x_i \\left(1 + \\frac{1}{r_i} \\sum_j A_{ij} x_j\\right)\\\\\n&= r_i x_i \\left(1 + \\sum_j B_{ij} x_j\\right)\\\\\n\\end{aligned}\n\\]\nwhere we have defined \\(B_{ij} = A_{ij} / r_i\\). In matrix form, we obtain:\n\\[\n\\dot{x} = D(x \\circ r) \\left(1_n + Bx \\right)\n\\]\nwhere \\(\\circ\\) is the Hadamard (element by element) product. This notation is convenient when computing the equilibria of the system; the previous notation is more convenient when investigating their stability. We will alternate between the two notations, using \\(A\\) and \\(B = D(r)^{-1} A\\) for the two matrices."
  },
  {
    "objectID": "lecture_1.html#equilibria",
    "href": "lecture_1.html#equilibria",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "If an equilibrium \\(x^\\star\\) in which all populations are present exists, it must be the solution of\n\\[\n\\begin{aligned}\n1_n + Bx^\\star &= 0_n\\\\\nBx^\\star &= - 1_n\\\\\nx^\\star &= -B^{-1} 1_n\n\\end{aligned}\n\\]\nwhen the matrix \\(B\\) is invertible. Naturally, the equilibrium must be positive (called feasible) to be biologically attainable.\nFor example, consider:\n\\[\nA = \\begin{pmatrix}\n-4 & -1 & -3\\\\\n-14 & -8 & -10\\\\\n-6 & -15 & -13\n\\end{pmatrix} \\quad r = \\begin{pmatrix}\n8\\\\\n32\\\\\n34\n\\end{pmatrix}\\quad B = D(r)^{-1}A = \\begin{pmatrix}\n-\\frac{1}{2} & -\\frac{1}{8} & -\\frac{3}{8}\\\\\n-\\frac{7}{16} & -\\frac{1}{4} & -\\frac{5}{16}\\\\\n-\\frac{3}{17} & -\\frac{15}{34} & -\\frac{13}{34}\n\\end{pmatrix}\n\\] There is an equilibrium when at which all populations are present:\n\\[\nx^\\star = -A^{-1} r = -B^{-1}1_n = \\begin{pmatrix}\n1\\\\\n1\\\\\n1\n\\end{pmatrix}\n\\] If the matrix \\(B\\) is rank-deficient (and thus singular) there are infinitely many equilibria; for example, if the rank of \\(B\\) is \\(n-1\\) there are infinitely many equilibria belonging to a line in \\(\\mathbb R^n\\).\nWhen \\(B\\) is nonsingular, the model admits at most one positive equilibrium in which all populations are present. However, there can be up to \\(2^n-1\\) equilibria in which one or more populations are absent/extinct. Call \\(B^{(k,k)}\\) the submatrix of \\(B\\) obtained by retaining the rows and columns indexed by the set \\(k\\). Then by solving\n\\[\nB^{(k,k)} x^{(k)\\star} = -1_{\\|k\\|}\n\\]\nwe obtain an equilibrium for the subcommunity where only the populations in \\(k\\) are present (provided that the equilibrium is feasibile).\nFor the example above, we have:\n\\[\nB^{(\\{1,2\\},\\{1,2\\})} = \\begin{pmatrix}\n-\\frac{1}{2}& -\\frac{1}{8}\\\\\n-\\frac{7}{16} & -\\frac{1}{4}\n\\end{pmatrix}\n\\]\nand\n\\[\nx^{(\\{1,2\\})\\star} = -(B^{(\\{1,2\\},\\{1,2\\})})^{-1}1_2=\\begin{pmatrix}\n\\frac{16}{9}\\\\\n\\frac{8}{9}\n\\end{pmatrix}\n\\]\nTherefore, the subsystem in which only the first two populations are present yields a feasible equilibrium.\nSimilarly,\n\\[\nx^{(\\{1,3\\})\\star} = \\begin{pmatrix}\n\\frac{1}{17}\\\\\n\\frac{44}{17}\n\\end{pmatrix} \\quad x^{(\\{1\\})\\star} = \\begin{pmatrix}\n2\\\\\n\\end{pmatrix} \\quad x^{(\\{2\\})\\star} = \\begin{pmatrix}\n4\\\\\n\\end{pmatrix} \\quad x^{(\\{3\\})\\star} = \\begin{pmatrix}\n\\frac{34}{13}\\\\\n\\end{pmatrix}\n\\]\nThe subsystem in which only populations 2 and 3 are present does not yield a feasible equilibrium."
  },
  {
    "objectID": "lecture_1.html#types-of-dynamics",
    "href": "lecture_1.html#types-of-dynamics",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "For a single population, the GLV model can yield only two outcomes: unbounded growth, or convergence to an equilibrium; if the equilibrium is \\(x^\\star = 0\\), we say that the population is extinct at the equilibrium.\n\n\n\n\n\nWhen we have two populations, we can also observe neutral cycles (as in the classic LV predator-prey system), and bistability (i.e., one population survives, while the other goes extinct; the identity of the population going extinct depends on the initial conditions).\n\n\n\n\n\nFor three populations we can observe limit cycles.\n\n\n\n\n\nFor three or more populations (in the general case), or four or more populations (in competitive systems), we can have chaos (i.e., non-periodic oscillations)."
  },
  {
    "objectID": "lecture_1.html#equilibrium-as-time-average",
    "href": "lecture_1.html#equilibrium-as-time-average",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "Suppose that \\(x(t)\\) has a periodic orbit, of period \\(T\\) (i.e., we assume \\(x(0) = x(T)\\)). Further, assume that the GLV has a feasible, interior equilibrium \\(x^\\star\\). We want to calculate the average density for each population:\n\\[\n\\frac{1}{T} \\int_0^T x(t) dt\n\\]\nFirst, we assume that \\(x(t) &gt; 0\\) and write the dynamics of its logarithm:\n\\[\n\\dfrac{d \\log(x_i(t))}{dt} = \\dfrac{1}{x_i(t)}\\dfrac{d x_i(t)}{dt} = r_i + \\sum_j A_{ij} x_j(t)\n\\]\nIn vector form:\n\\[\n\\dfrac{d \\log{x(t)}}{dt}= r + A x(t)\n\\]\nCompute the average on both sides:\n\\[\n\\frac{1}{T}\\int_0^T \\frac{d \\log(x(t))}{dt} dt= \\frac{1}{T}\\int_0^T \\left(r + Ax(t) \\right) dt\n\\]\nyielding:\n\\[\n\\frac{1}{T}(\\log(x(T)) - \\log(x(0))) = 0_n = r + A \\left( \\frac{1}{T} \\int_0^T x(t) dt \\right)\n\\]\nNote that the l.h.s. is zero because \\(x(0) = x(T)\\). Now rearrange:\n\\[\n-r = A \\left( \\frac{1}{T} \\int_0^T x(t) dt \\right)\n\\]\nMultiplying by the matrix inverse:\n\\[\n-A^{-1} r = x^\\star =  \\frac{1}{T} \\int_0^T x(t) dt\n\\]\nshowing that the average density is in fact the equilibrium. With a similar argument, one can prove that if the trajectory stays in a compact space (i.e., in case of chaotic attractors), then the long-time average is still \\(x^\\star\\).\n\n\n\n\n\nSemi-transparent lines: trajectories; dashed lines: equilibrium values; solid line: (cumulative) average of trajectory."
  },
  {
    "objectID": "lecture_1.html#coexistence-requires-a-feasible-equilibrium",
    "href": "lecture_1.html#coexistence-requires-a-feasible-equilibrium",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "A necessary condition for the coexistence of populations is the existence of a positive (feasible) equilibrium.\n\n\n\n\n\n\nFarkas’ lemma\n\n\n\n\n\nConsider matrix \\(A\\), of size \\(n \\times n\\), and the vector \\(b\\), of length \\(n\\).\nThen either:\n\\[\n\\exists x \\geq 0_n \\quad \\mid \\quad Ax = b\n\\]\nor:\n\\[\n\\exists y \\in \\mathbb R^n \\quad \\mid \\quad A^T y \\geq 0 \\;\\text{and}\\; b^T y &lt; 0\n\\]\n\n\n\nSuppose that the system does not have a feasible equilibrium, i.e., an \\(x^\\star &gt; 0_n\\) such that \\(Ax^\\star = -r\\). Then, there must exist a \\(y\\) such that \\(A^T y \\geq 0_n\\) and \\(r^T y &gt; 0\\).\nBut then, consider the function:\n\\[\nP = \\prod_i x_i^{y_i}\n\\]\nThe function is positive when all \\(x_i &gt; 0\\). Differentiating with respect to time, we find:\n\\[\n\\begin{aligned}\n\\dot{P} &= \\sum_i\\left( y_i \\dot{x}_i x_i^{y_i - 1} \\prod_{j \\neq i} x_j^{y_j} \\right)\\\\\n&=\\sum_i\\left( y_i \\frac{\\dot{x}_i}{x_i} \\prod_{j} x_j^{y_j} \\right)\\\\\n&= P \\sum_i y_i \\left(r_i + \\sum_j A_{ij} x_j\\right)\\\\\n&= P (y^T r + y^T A x)\n\\end{aligned}\n\\]\nbut by Farkas’ lemma, we have that \\(y^T r &gt; 0\\) and \\(y^TA \\geq 0_n^T\\); then \\(P\\) always grows in time, and eventually diverges to \\(\\infty\\).\nNote that \\(P(t) \\to \\infty\\) requires some \\(x_i^{y_i}(t) \\to \\infty\\), which happens when either \\(x_i(t) \\to \\infty\\) and \\(y_i &gt; 0\\) (i.e., a population grows without bound), or \\(x_i(t) \\to 0\\) and \\(y_i &lt; 0\\) (i.e., a population goes extinct). Thus, in the absence of an equilibrium, trajectories can either diverge to infinity, or one or more populations can go extinct.\nA feasible equilibrium is therefore a necessary condition for coexistence."
  },
  {
    "objectID": "lecture_1.html#local-stability",
    "href": "lecture_1.html#local-stability",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "We want to determine whether an equilibrium point is locally asymptotically stable; this means that, for sufficiently small perturbations of the equilibrium, \\(x(0) = x^\\star + \\epsilon\\), we have that \\(\\lim_{t \\to \\infty} x(t) = x^\\star\\). Let’s start by considering the case of a single population:\n\nTake an ODE \\(dx/dt = f(x)\\)\nThe population is resting at an equilibrium \\(x^\\star\\)\nWe perturb the population abundance, and track the dynamics when starting at \\(x(0) = x^\\star + \\epsilon\\), where \\(\\epsilon\\) (the perturbation) is taken to be sufficiently small \\(\\| \\epsilon \\| \\ll 1\\)\nWe write \\(\\Delta x(0) = x(0) - x^\\star\\)\nWe derive the dynamics for \\(\\Delta x\\).\n\nBy chain rule,\n\\[\n\\begin{aligned}\n\\dfrac{d \\Delta x}{dt} &= \\dfrac{d \\Delta x}{dx} \\dfrac{d x}{dt} \\\\\n&= 1 \\dfrac{d x}{dt}\\\\\n&= f(x)\\\\\n&= f(\\Delta x + x^\\star)\n\\end{aligned}\n\\]\nWhere we have substituted \\(x = \\Delta x + x^\\star\\).\n\nNow we approximate the function \\(f(\\Delta x + x^\\star)\\) by Taylor-expanding.\n\n\n\n\n\n\n\nTaylor series\n\n\n\n\n\nWe can approximate the behavior of a (infinitely differentiable) function in the vicinity of a point \\(a\\) by a power series:\n\\[\nf(x) = f(a) + \\dfrac{1}{1!} \\left. \\dfrac{df(x)}{dx} \\right|_a (x-a)+ \\dfrac{1}{2!} \\left. \\dfrac{d^2f(x)}{dx^2} \\right|_a (x-a)^2+ \\dfrac{1}{3!} \\left. \\dfrac{d^3f(x)}{dx^3} \\right|_a (x-a)^3 + \\ldots\n\\]\nwhere \\(n! = n (n-1)(n-2)\\ldots 1\\) is the factorial function and the derivatives are evaluated at \\(a\\). When we choose \\(a=0\\), this is called the Maclaurin series.\nExample\nExpand \\(e^x\\) around \\(0\\):\n\\[\n\\begin{aligned}\ne^x &= e^0 + \\left. e^x\\right|_0 x + \\frac{1}{2}\\left. e^x\\right|_0 x^2  + \\frac{1}{6}\\left. e^x\\right|_0 x^3 + \\ldots\\\\\n&=1 + x + \\frac{1}{2} x^2  + \\frac{1}{6}x^3 + \\ldots\\\\\n&=\\sum_{k=0}^\\infty \\frac{x^k}{k!}\n\\end{aligned}\n\\]\n\n\n\nWe want to Taylor-expand \\(f(x) = f(\\Delta x + x^\\star)\\) around \\(x^\\star\\):\n\\[\nf(x) = f(x^\\star) + \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} (x - x^\\star) + \\dfrac{1}{2}\\left.\\dfrac{d^2 f(x)}{d x^2}\\right|_{x^\\star} (x - x^\\star)^2 + \\ldots\n\\]\nNote that \\(f(x^\\star) = 0\\) by the definition of an equilibrium. If the deviation is small, we can neglect all the higher-order terms, obtaining:\n\\[\n\\dfrac{d \\Delta x}{dt} = f(x) \\approx \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} \\Delta x\n\\]\nwhich is the equation of the exponential growth model, with \\(\\rho = \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star}\\). Then, the solution is \\(\\Delta x(t) = \\Delta x(0) e^{\\rho t}\\), and the deviation from the equilibrium eventually reaches zero (i.e., the system goes back to \\(x^\\star\\)) whenever \\(\\rho &lt; 0\\).\nFor example, take the logistic growth model \\(\\dot{x} = x(1-x)\\), and evaluate the stability of \\(x^\\star = 1\\); we have:\n\\[\n\\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} = \\left.\\dfrac{d (x - x^2)}{d x}\\right|_{x^\\star} = \\left.(1 - 2x)\\right|_{x^\\star} = -1\n\\]\nand thus the equilibrium is locally asymptotically stable. Locally, because we have considered very small deviations from the equilibrium, and asymptotic because convergence only happens eventually.\nIn analogy with the Taylor-expansion of functions of a single variable, we can write:\n\\[\nf_i(x^\\star + \\Delta x) = f_i(x^\\star) + \\sum_k \\left. \\dfrac{\\partial f_i(x)}{\\partial x_k} \\right|_{x^\\star} \\Delta x_k + \\dfrac{1}{2} \\sum_{k}\\sum_{l} \\left. \\dfrac{\\partial^2 f_i(x)}{\\partial x_k \\partial x_l} \\right|_{x^\\star} \\Delta x_k \\Delta x_l + \\cdots\n\\]\nAs before, \\(f_i(x^\\star) = 0\\), and if we take only the second term (i.e., the term linear in \\(\\Delta x\\)) we can approximate the function as:\n\\[\nf_i(x^\\star + \\Delta x) \\approx \\sum_k \\left. J_{ik} \\right|_{x^\\star} \\Delta x_k\n\\]\nWhere we have defined the Jacobian matrix \\(J\\):\n\\[\nJ_{ij} = \\dfrac{\\partial f_i(x)}{\\partial x_j}\n\\]\nFor each equilibrium of the system, we can obtain a different community matrix (the name is due to Richard Levins) \\(M\\):\n\\[\nM = \\left. J \\right|_{x^\\star}\n\\]\nAs such, a system of ODEs has a single Jacobian, and as many community matrices as there are equilibria. As before, we assume that we have slightly perturbed the system at equilibrium, \\(x(t) = x^\\star + \\Delta x\\), where \\(\\Delta x\\) is assumed to be small, and then we approximate the dynamics:\n\\[\n\\dfrac{d\\Delta x}{dt} \\approx \\left. J \\right|_{x^\\star} \\Delta x\n\\]\ni.e., we need to solve a linear system of ODEs.\n\n\n\n\n\n\nSolving systems of linear ODEs\n\n\n\n\n\nConsider the system of first-order, autonomous ODEs:\n\\[\n\\dfrac{dx}{dt} = Ax\n\\]\nIf the matrix \\(A\\) is diagonalizable, we can decompose the matrix as:\n\\[\nA = Q \\Lambda Q^{-1}\n\\]\nWe define a new system of equations, by changing the variables:\n\\[\ny = Q^{-1}x\\quad x = Q y\n\\]\nThen, by chain rule:\n\\[\n\\dfrac{dy}{dt} = Q^{-1} \\dfrac{d x}{dt} = Q^{-1}Q \\Lambda Q^{-1} x= \\Lambda Q^{-1} x = \\Lambda y\n\\]\nWe have decoupled all equations: now the \\(y_i\\) grow or decline independently of each other.\n\\[\n\\dfrac{dy_i}{dt} = \\lambda_i y_i\n\\]\nThis is in fact the equation for the exponential growth/decay, with solution \\(y_i(t) = y(0) e^{\\lambda_i t}\\).\nWe can bring these solutions back to the original form:\n\\[\ny(t) = e^{\\Lambda t} y(0)\n\\]\nwhere \\(e^{\\Lambda t}\\) is a diagonal matrix:\n\\[\ne^{\\Lambda t}= \\begin{pmatrix}\ne^{\\lambda_1 t} & 0 & \\cdots &0\\\\\n0 & e^{\\lambda_2 t} & \\cdots &0\\\\\n\\cdots & \\cdots & \\cdots & \\cdots\\\\\n0 & 0 & \\cdots & e^{\\lambda_n t}\\\\\n\\end{pmatrix}\n\\]\nThen:\n\\[\nx(t) = Q y(t) = Q e^{\\Lambda t} y(0) = Q e^{\\Lambda t} Q^{-1} x(0)\n\\]\nAllowing to easily compute the solution for any linear systems of ODEs.\nStability of the origin\nSuppose that \\(\\lambda_i\\) is a real, negative number; then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = 0\\). If \\(\\lambda_i\\) is positive, on the other hand, then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = \\infty\\). Thus, if any of the \\(\\lambda_i &gt; 0\\), the system will initially move toward \\(\\infty\\) in the direction specified by the corresponding eigenvector.\nWhenever \\(\\lambda_i\\) is complex (e.g., generically, when \\(A\\) is not symmetric), then we need to consider:\n\\[\ne^{\\alpha t + i \\beta t} = e^{\\alpha t} e^{i \\beta t} = e^{\\alpha t} (\\cos \\beta + i \\sin \\beta )t\n\\]\nwhere we have used Euler’s formula. Importantly, \\((\\cos \\beta + i \\sin \\beta )\\) is bounded, and in fact its real (imaginary) part is \\(\\leq 1\\) (the equation describes a unit circle in the complex plane). Then, \\(\\lim_{t \\to \\infty} e^{\\alpha t + i \\beta t} = 0\\) if \\(\\alpha &lt; 0\\).\nTherefore, the vector \\(0_n\\) is an asymptotically stable equilibrium of the system \\(\\dfrac{dx}{dt} = A x\\) if and only if all the eigenvalues of \\(A\\) have negative real part.\nStability of the origin for \\(A_{2 \\times 2}\\)\nAs we have shown above, the eigenvalues of a \\(2\\times2\\) matrix \\(A\\):\n\\[\nA = \\begin{pmatrix}\na & b\\\\\nc & d\n\\end{pmatrix}\n\\]\nare:\n\\[\n\\lambda = \\dfrac{a + d \\pm \\sqrt{4bc + (a-d)^2}}{2}\n\\]\nWe can rewrite the values as:\n\\[\n\\lambda = \\dfrac{1}{2} \\left(\\text{Tr}A \\pm\\sqrt{\\left(\\text{Tr}A \\right)^2 - 4 \\det A} \\right)\n\\]\nIf the trace is negative, and the determinant positive, then the eigenvalues have negative real part, and thus the origin is stable for the corresponding system of linear ODEs. In fact, knowing the trace and the determinant is in this case sufficient to determine the type of dynamics around equilibrium:\n\n\n\nCharacterizing dynamics using trace and determinant\n\n\n\n\n\nTo probe the local asymptotic stability of the equilibria, we can:\n\nCalculate the Jacobian matrix, \\(J\\)\nPlug in an equilibrium, obtaining the corresponding community matrix \\(M\\)\nCompute the eigenvalues of \\(M\\), \\(\\lambda_i\\)\nIf all the eigenvalues have negative real part, \\(\\Re (\\lambda_i) &lt; 0\\), then the equilibrium is locally asymptotically stable; if any \\(\\Re (\\lambda_i) &gt; 0\\), then the equilibrium is unstable, and there are small perturbations that will amplify (at least initially)\n\nFor the GLV system with equilibrium \\(x^\\star = -A^{-1}r &gt; 0_n\\), we have:\n\\[\nJ_{ii} = \\dfrac{\\partial (r_i x_i + \\sum_j A_{ij} x_i x_j)}{\\partial x_i}  = r_i + \\sum_j A_{ij} x_j + A_{ii} x_i\n\\]\nAt equilibrium, we have:\n\\[\nr_i + \\sum_j A_{ij} x_j^\\star = 0\n\\]\nand therefore\n\\[\nM_{ii} = \\left. J_{ii} \\right|_{x^\\star} = A_{ii} x_i^\\star\n\\]\nSimilarly,\n\\[\nJ_{ii} = \\dfrac{\\partial (r_i x_i + \\sum_j A_{ij} x_i x_j)}{\\partial x_j}  = A_{ij} x_i\n\\]\nand thus\n\\[\nM_{ij} = \\left. J_{ij} \\right|_{x^\\star} = A_{ij} x_i^\\star\n\\]\nPutting them together, we obtain:\n\\[\nM = \\left. J \\right|_{x^\\star} = D(x^\\star)A\n\\]\nand thus the equilibrium is l.a.s. if and only if all of the eigenvalues of \\(D(x^\\star)A\\) have negative real part.\nIf the matrix \\(A\\) is symmetric, any feasible equilibrium is stable if and only if the eigenvalues of \\(A\\) are all negative (i.e., \\(A\\) is negative definite). To prove this, take \\(A = A^T\\) and consider the similarity transformation\n\\[\n\\begin{aligned}\nD(x^\\star)^{-\\frac{1}{2}} D(x^\\star) A D(x^\\star)^{\\frac{1}{2}}\\\\\nD(x^\\star)^{\\frac{1}{2}}  A D(x^\\star)^{\\frac{1}{2}}\\\\\n\\end{aligned}\n\\]\nThe matrices \\(D(x^\\star) A\\) and \\(D(x^\\star)^{\\frac{1}{2}} A D(x^\\star)^{\\frac{1}{2}}\\) are similar, and thus have the same eigenvalues; the matrices \\(A\\) and \\(D(x^\\star)^{\\frac{1}{2}} A D(x^\\star)^{\\frac{1}{2}}\\) are congruent, and thus have the same number of positive, negative and zero eigenvalues by Sylvester’s law of inertia.\nA symmetric matrix is negative definite if all its submatrices obtained by deleting a set of rows and the corresponding columns are negative definite as well. Then, if \\(A = A^T\\) is negative definite, a) a feasible equilibrium is locally stable, and b) for any subsystem, feasibility implies local stability.\nNote that this is generally not the case for nonsymmetric matrices \\(A\\), in which case we could have that \\(A\\) has all eigenvalues with a negative real part, while \\(D(x^\\star)A\\) has some eigenvalues with positive real part (or viceversa). For example, take\n\\[\nA = \\begin{pmatrix}\n-3 & 4 & 0\\\\\n5 & -2 & -2\\\\\n5 & 5 & -3\n\\end{pmatrix} \\quad \\lambda(A) = \\{-7,\\frac{1}{2}(-1 \\pm i \\sqrt{15}) \\}\n\\]\nand the equilibrium \\(x^\\star = (1,1,1/2)^T\\) (obtained for \\(r = (-1, -2, -17/2)\\)); we obtain:\n\\[\nM = D(x^\\star)A = \\begin{pmatrix}\n-3 & 4 & 0\\\\\n5 & -2 & -2\\\\\n\\frac{5}{2} & \\frac{5}{2} & -\\frac{3}{2}\n\\end{pmatrix} \\quad \\lambda(B) = \\{-7,\\frac{1}{4}(1 \\pm i\\sqrt{31}) \\}\n\\]\nThus, the equilibrium is not locally asymptotically stable."
  },
  {
    "objectID": "lecture_1.html#global-asymptotic-stability",
    "href": "lecture_1.html#global-asymptotic-stability",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "In certain models, we can show that whenever all the populations start at a positive value, they will always reach a certain equilibrium \\(x^\\star\\). In this case, we say the equilibrium is globally asymptotically stable.\nBecause solving differential equations is in general very difficult, and in many cases of interest impossible, we employ a proxy function, called a Lyapunov function.\n\n\n\n\n\n\nLyapunov functions\n\n\n\n\n\nWe want to prove that all trajectories originating at \\(x(0) &gt; 0\\) eventually converge to \\(x^\\star\\). If we can find a function \\(V\\) such that:\n\n\\(V(x(t)) \\geq 0\\) for all \\(x(t) &gt; 0\\)\n\\(V(x(t)) = 0\\) if and only if \\(x(t) = x^\\star\\)\n\\(\\dfrac{d V(x(t))}{dt} \\leq 0\\) for all \\(x(t)\\) and\n\\(\\dfrac{d V(x(t))}{dt} = 0\\) if and only if \\(x(t) = x^\\star\\)\n\nthen \\(x^\\star\\) is globally asymptotically stable: all trajectories starting at a positive point will converge to it.\nThe logic of this procedure is to identify a suitable function \\(V\\) that is positive everywhere but at the equilibrium, and is always declining in time; then necessarily the function will eventually reach zero, which is attained only at equilibrium.\nExample\n\\(V(x(t)) = (x(t) - x^\\star)^2\\) is a Lyapunov function for the logistic growth model \\(dx/dt = x(1-x)\\): the model has an equilibrium \\(x^\\star = 1\\) that is globally asymptotically stable.\n\n\\(V(x(t))\\) is always nonnegative, and is zero only at \\(x(t) = x^\\star = 1\\)\nThe derivative of \\(V(x(t))\\) w.r.t. time is:\n\n\\[\n\\begin{aligned}\n\\dfrac{dV(t)}{dt} &= \\dfrac{dV(t)}{dx(t)}\\dfrac{dx(t)}{dt}\\\\\n&= 2(x(t) - x^\\star)\\dfrac{dx(t)}{dt}\\\\\n&=-2(x(t)-1) x(t)(x(t)-1)\\\\\n&=-2 x(t) (x(t)-1)^2 \\leq 0\n\\end{aligned}\n\\]\n\n\n\nThere are two classic candidate Lyapunov functions for Lotka-Volterra models. The first is due to MacArthur, and shows that, when interactions are symmetric and the matrix of interactions is negative definite (i.e., has only negative eigenvalues), the feasible equilibrium is globally stable.\nWe consider a slightly modified version of MacArthur’s function, and assume \\(A = A^T\\):\n\\[\nW(x) = r^Tx^\\star - (2 r^T x + x^T A x)\n\\]\nWhenever \\(A\\) is negative definite, then \\(W(x(t))\\) is positive everywhere but at equilibrium (the function is convex), and has a single minimum at the equilibrium. Note that, whenever \\(x^\\star &gt; 0_n\\) is an equilibrium, then\n\\[\n\\begin{aligned}\nr + A x^\\star &= 0_n\\\\\nr &= -Ax^\\star\n\\end{aligned}\n\\]\nSubstitute these values in the function \\(W\\), to obtain:\n\\[\n\\begin{aligned}\nW(x^\\star) &= r^Tx^\\star - (2 r^T x^\\star + (x^\\star)^T A x^\\star) \\\\\n&=r^Tx^\\star - (2 r^T x^\\star + ((x^\\star) A)^T x^\\star)\\\\\n&=r^Tx^\\star - (2 r^T x^\\star -r^T x^\\star)\\\\\n&=0_n\n\\end{aligned}\n\\]\nDifferentiating with respect to time, we find:\n\\[\n\\begin{aligned}\n\\dot{W}(x(t)) &= -(2 r^T \\dot{x} + \\dot{x}^T A x + x^T A \\dot{x})\\\\\n&= -(2 r^T \\dot{x} + \\dot{x}^T A^T x + x^T A \\dot{x})\\\\\n&= -2 (r + Ax)^T \\dot{x}\\\\\n&= -2 (r + Ax)^T D(x) (r + Ax)\\\\\n&=-2 \\sum_i x_i (r_i + (Ax)_i)^2 \\leq 0\n\\end{aligned}\n\\]\nA more general candidate Lyapunov function is due to Goh, and shows that, whenever there exists a positive diagonal matrix \\(D(w)\\) such that \\(D(w)A^T + AD(w)\\) is negative definite, then the equilibrium \\(x^\\star &gt; 0_n\\) is globally stable.\nWe start with the simplest case in which \\(w = 1_n\\) and thus \\(D(w) = I\\). Take the function\n\\[\nV(x(t)) = \\sum_i \\left(x_i - x_i^\\star - x_i^\\star \\log \\frac{x_i}{x_i^\\star} \\right)\n\\]\nThe function is positive for every \\(x \\in \\mathbb {R^n}_+\\), because \\(z - 1 - \\log z \\geq 0\\) whenever \\(z &gt; 0\\); take \\(z = x_i / {x_i}^\\star\\) and then multiply by \\({x_i}^\\star\\) to prove that the function is nonnegative.\nDifferentiating with respect to time, we find:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= \\sum_i \\left(\\dot{x}_i - x_i^\\star \\frac{\\dot{x}_i}{x_i} \\right)\\\\\n&= \\sum_i \\left(x_i (r_i + (Ax)_i) - x_i^\\star (r_i + (Ax)_i)\\right)\\\\\n&=\\sum_i \\Delta x_i (-(Ax^\\star)_i + (Ax)_i )\\\\\n&=\\sum_{i,j}\\Delta x_i A_{ij} \\Delta x_j\\\\\n&=\\Delta x^T A \\Delta x\\\\\n&=\\frac{1}{2}\\Delta x^T (A + A^T)\\Delta x\\\\\n\\end{aligned}\n\\]\nThus, if the symmetric part of \\(A\\), \\(H(A) = \\frac{1}{2} (A + A^T)\\) is negative definite, then \\(\\dot{V}(x(t))&lt;0\\) for every \\(\\Delta x \\neq 0\\) and the equilibrium is stable.\nTo extend the reach of the candidate function, consider the change of variables:\n\\[\nz_i = x_i / w_i \\quad x_i = w_i z_i\n\\]\nwith \\(w_i&gt;0\\). This change of variables cannot impact the existence or stability of equilibria (we are simply changing the units of measure we are using to measure the density of each population). Then,\n\\[\n\\dot{z_i} = \\frac{\\dot{x}_i}{w_i} = \\frac{x_i}{w_i}(r_i + (Ax)_i) = z_i(r_i + (AD(w)z)_i)=z_i(r_i + (\\tilde{A}z)_i)\n\\]\nThus, if \\(H(\\tilde{A}) = \\frac{1}{2} (AD(w) + D(w)A^T)\\) is negative definite, the equilibrium is stable."
  },
  {
    "objectID": "lecture_1.html#global-stability-and-saturated-equilibria",
    "href": "lecture_1.html#global-stability-and-saturated-equilibria",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "When Goh’s function holds, we can prove that dynamics starting from positive conditions \\(x(t)&gt;0_n\\) will converge to a saturated equilibrium \\(\\tilde{x}\\) characterized by two conditions. We have \\(n\\) populations, and at the saturated equilibrium the populations in set \\(k\\) coexist at a globally stable equilibrium, and the remaining populations, belonging to set \\(n-k\\) are extinct, and cannot re-invade the system starting from low abundance.\nWithout loss of generality, we can order the populations such that the first \\(\\|k\\|\\) populations are those that coexist at the saturated equilibrium, and the remaining \\(\\| n- k\\|\\) are those extinct at the saturated equilibrium. We partition all variables according to the two sets:\n\\[\nx = \\begin{pmatrix}\ny\\\\\nz\n\\end{pmatrix} \\quad \\tilde{x} = \\begin{pmatrix}\ny^\\star\\\\\n0_{n-k}\n\\end{pmatrix} \\quad A = \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\quad r = \\begin{pmatrix}\n\\mathfrak r\\\\\n\\mathfrak s\n\\end{pmatrix}\n\\]\nWe consider a minor modification of Goh’s function:\n\\[\nV(x (t)) = \\sum_{i \\in k} \\left(y_i - y_i^\\star - y_i^\\star \\log \\frac{y_i}{y_i^\\star} \\right) +\n\\sum_{i \\in n-k} z_i\n\\]\nDifferentiating with respect to time, we obtain:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= \\sum_{i \\in k} \\left(\\dot{y}_i - y_i^\\star \\frac{\\dot{y}_i}{y_i} \\right)+\\sum_{i \\in n-k} \\dot{z}_i\\\\\n&=\\Delta y^T(\\mathfrak r + \\mathfrak A y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C y+ \\mathfrak D z)\n\\end{aligned}\n\\]\nNow we substitute \\(\\mathfrak r = -\\mathfrak A y^\\star\\), and add and subtract \\(z^T \\mathfrak C y^\\star\\):\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &=\\Delta y^T(-\\mathfrak A y^\\star + \\mathfrak A y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C y+ \\mathfrak D z  + \\mathfrak C y^\\star - \\mathfrak C y^\\star)\\\\\n&=\\Delta y^T(\\mathfrak A \\Delta y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C \\Delta y+ \\mathfrak D z  + \\mathfrak C y^\\star)\n\\end{aligned}\n\\] Now we write the function as the sum of two parts:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= (\\Delta y^T \\mathfrak A \\Delta y + \\Delta y^T \\mathfrak B z + z^T \\mathfrak C \\Delta y + z^T \\mathfrak D z) + z^T(s + \\mathfrak C y^\\star)\\\\\n&= \\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}^T \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}+ z^T(s + \\mathfrak C y^\\star)\\\\\\\\\n&= \\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}^T A\\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}+ z^T(s + \\mathfrak C y^\\star)\\\\\\\\\n\\end{aligned}\n\\]\nWhenever \\(H(A) = \\frac{1}{2}(A + A^T)\\) is negative definite, then the first term is negative for any choice of \\(y\\) and \\(z\\). Examining the second term, we see that \\(\\mathfrak s + \\mathfrak C y^\\star\\) measures the invasion growth rate of the populations in the set \\(n-k\\) when they are attempting to invade the community that is resting at \\(y^\\star\\). Thus, if we can find a saturated equilibrium, it is globally stable and will be reached for any \\(x(0) &gt; 0_n\\).\nThis derivation can be extended by considering a diagonal matrix \\(D(w)\\) with \\(w &gt;0_n\\), as done above."
  },
  {
    "objectID": "lecture_1.html#classic-papers-references-and-further-readings",
    "href": "lecture_1.html#classic-papers-references-and-further-readings",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "A brief paper discussing how to build models in biology:\n\nRichard Levins, 1966. The strategy of model building in population biology. American Scientist 54:421-431\n\nThe Lotka-Volterra predator-prey model was discovered independently by Alfred J. Lotka and Vito Volterra:\n\nAlfred J. Lotka, 1920. Analytical Note on Certain Rhythmic Relations in Organic Systems. PNAS 6 (7) 410-415\nVito Volterra, 1926. Fluctuations in the Abundance of a Species Considered Mathematically. Nature 118:558-60\n\nYou can read their exchange here.\nThe constant of motion that underlies the candidate Lyapunov functions was derived by Lotka in 1920:\n\nAlfred J. Lotka, 1920. Undamped oscillations derived from the law of mass action. Journal of the American Chemical Society 42:1595-1599\n\nVolterra considered many variations, including the competition between species. His results caught the eye of an experimentalist, who validated the principle of competitive exclusion using protozoans:\n\nG.F. Gause, 1934. Experimental Analysis of Vito Volterra’s Mathematical Theory of the Struggle for Existence. Science 79:16-17\n\nThe variety of dynamics displayed by GLV:\n\nSmale, S., 1976. On the differential equations of species in competition. Journal of Mathematical Biology, 3(1), pp.5-7.\nArneodo, A., Coullet, P. and Tresser, C., 1980. Occurence of strange attractors in three-dimensional Volterra equations. Physics Letters A, 79(4), pp.259-263.\nVano, J.A., Wildenberg, J.C., Anderson, M.B., Noel, J.K. and Sprott, J.C., 2006. Chaos in low-dimensional Lotka–Volterra models of competition. Nonlinearity, 19(10), p.2391.\n\nThe paper by MacArthur, on consumer-resource dynamics:\n\nR. MacArthur, 1970. Species packing and competitive equilibrium for many species. Theoretical population biology, 1(1), pp.1-11.\n\nThe paper by B.S. Goh on global stability:\n\nB.S. Goh, 1977. Global stability in many-species systems. The American Naturalist, 111(977), pp.135-143.\n\nThe convergence to saturated equilibria has strong implications for ecological assembly. See for example:\n\nJ. Hofbauer, S.J. Schreiber, 2022. Permanence via invasion graphs: incorporating community assembly into modern coexistence theory. Journal of mathematical biology. Nov;85(5):54.\nC.A. Serván, S. Allesina, 2021. Tractable models of ecological assembly. Ecology Letters May;24(5):1029-37.\n\nI have recently written a paper on Lyapunov functions for GLV that extends and generalizes Goh’s function. Ask me about it if you want to know more!\n\nS. Allesina, 2025. Global stability of ecological and evolutionary dynamics via equivalence. In review"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "QEco 2025",
    "section": "",
    "text": "We have three lectures and a tutorial. We are going to concentrate on the Generalized Lotka-Volterra model—which turns 100 years old in 2026.\n\nLecture 1. The Generalized Lotka-Volterra model for \\(n\\) interacting populations.\nLecture 2. GLV with random parameters; metapopulations.\nLecture 3. GLV to model experimental data.\n\n\n\nThe GitHub repository associated with the lecture notes contains the code used to generate the lecture notes, including all the figures and simulations. Crucially, the code depends on the following R packages:\n\nlibrary(tidyverse) # plotting, data organization\nlibrary(deSolve) # integrate differential equations\n\n\n\n\n\nWe write \\(x(t)\\) for the density of population \\(x\\) at time \\(t\\). In many cases, we will write simply \\(x\\), as the dependency on time is always assumed. For discrete-time models, we write \\(x_t\\) instead. Typically, \\(x(t)\\) is measured in either \\([\\text{mass}]/[\\text{area/volume}]\\) or \\([\\text{number of individuals}]/[\\text{area/volume}]\\)\nThe density of a population typically changes in time, and the change is modulated by several parameters. Unless specified, we use Greek letters for scalars, lower-case Latin letters for vectors, and upper-case Latin letters for matrices.\nOther useful notation:\n\n\\(i\\) is the imaginary unit, such that \\(i^2 = -1\\)\n\\(0_n\\) is a vector of zeros of lenght \\(n\\)\n\\(1_n\\) is a vector of ones of lenght \\(n\\)\n\\(I\\) is the identity matrix (i.e., a matrix with \\(1_n\\) on the diagonal, and zeros elsewhere)\n\\(D(a)\\) is a diagonal matrix with vector \\(a\\) on the diagonal\n\\(H(A)\\) is the symmetric part of matrix \\(A\\): \\(H(A) = \\frac{1}{2} (A + A^T)\\)\n\\(\\circ\\) is the Hadamard (element by element) product (i.e., \\(a \\circ b = c\\) with \\(c_i = a_i b_i\\), the same holds for matrices)\n\\(\\dfrac{d x(t)}{dt}\\) is sometimes written as \\(\\dfrac{d x}{dt}\\) or \\(\\dot{x}\\)"
  },
  {
    "objectID": "index.html#computing",
    "href": "index.html#computing",
    "title": "QEco 2025",
    "section": "",
    "text": "The GitHub repository associated with the lecture notes contains the code used to generate the lecture notes, including all the figures and simulations. Crucially, the code depends on the following R packages:\n\nlibrary(tidyverse) # plotting, data organization\nlibrary(deSolve) # integrate differential equations"
  },
  {
    "objectID": "index.html#notation",
    "href": "index.html#notation",
    "title": "QEco 2025",
    "section": "",
    "text": "We write \\(x(t)\\) for the density of population \\(x\\) at time \\(t\\). In many cases, we will write simply \\(x\\), as the dependency on time is always assumed. For discrete-time models, we write \\(x_t\\) instead. Typically, \\(x(t)\\) is measured in either \\([\\text{mass}]/[\\text{area/volume}]\\) or \\([\\text{number of individuals}]/[\\text{area/volume}]\\)\nThe density of a population typically changes in time, and the change is modulated by several parameters. Unless specified, we use Greek letters for scalars, lower-case Latin letters for vectors, and upper-case Latin letters for matrices.\nOther useful notation:\n\n\\(i\\) is the imaginary unit, such that \\(i^2 = -1\\)\n\\(0_n\\) is a vector of zeros of lenght \\(n\\)\n\\(1_n\\) is a vector of ones of lenght \\(n\\)\n\\(I\\) is the identity matrix (i.e., a matrix with \\(1_n\\) on the diagonal, and zeros elsewhere)\n\\(D(a)\\) is a diagonal matrix with vector \\(a\\) on the diagonal\n\\(H(A)\\) is the symmetric part of matrix \\(A\\): \\(H(A) = \\frac{1}{2} (A + A^T)\\)\n\\(\\circ\\) is the Hadamard (element by element) product (i.e., \\(a \\circ b = c\\) with \\(c_i = a_i b_i\\), the same holds for matrices)\n\\(\\dfrac{d x(t)}{dt}\\) is sometimes written as \\(\\dfrac{d x}{dt}\\) or \\(\\dot{x}\\)"
  }
]